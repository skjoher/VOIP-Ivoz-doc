

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>IvozProvider Oasis documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="_static/banner.css" type="text/css" />
  

  
        <link rel="index" title="Index"
              href="genindex.html"/>
        <link rel="search" title="Search" href="search.html"/>
    <link rel="top" title="None" href="index.html#document-index"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html#document-index" class="icon icon-home"> IvozProvider
          

          
          </a>

          
            
            
              <div class="version">
                1.0
              </div>
            
          

          

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <p class="caption"><span class="caption-text">Basic Concepts</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-intro/index">Introduction to IvozProvider</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-architecture/index">[P] Platform general architecture</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-operation_roles/index">Platform roles</a></li>
</ul>
<p class="caption"><span class="caption-text">Minimum Configuration</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-installation/index">Initial Installation</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-internal_calls/index">Make an internal call</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-external_incoming_calls/index">Receive external calls</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-external_outgoing_calls/index">Realizar llamadas externas</a></li>
</ul>
<p class="caption"><span class="caption-text">Advanced Configuration</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-pbx_features/index">Funcionalidades de PBX</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-billing_and_invoices/index">Tarificación y facturación</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-provisioning/index">[P] Provisión de terminales</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-faxing/index">Faxing Virtual</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-userportal/index">[P] Portal de Usuario</a></li>
</ul>
<p class="caption"><span class="caption-text">Security and Maintenance</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-security/index">[S] Elementos de seguridad</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-maintenance/index">[P] Mantenimiento de la solución</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html#document-index">IvozProvider</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          





<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html#document-index">Docs</a> &raquo;</li>
      
    <li>IvozProvider Oasis documentation</li>
      <li class="wy-breadcrumbs-aside">
        
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="admonition danger">
<p class="first admonition-title">Danger</p>
<p>Work in progress:</p>
<blockquote>
<div><ul class="simple">
<li><strong>[P]</strong>: Pending (not even started)</li>
<li><strong>[S]</strong>: Started (but not finished)</li>
</ul>
</div></blockquote>
<p class="last">Not marked sections are finished.</p>
</div>
<div class="section" id="ivozprovider-official-documentation">
<h1>IvozProvider Official Documentation<a class="headerlink" href="#ivozprovider-official-documentation" title="Permalink to this headline">¶</a></h1>
<div class="toctree-wrapper compound" id="concepts">
<span id="document-intro/index"></span><div class="section" id="introduction-to-ivozprovider">
<h2>Introduction to IvozProvider<a class="headerlink" href="#introduction-to-ivozprovider" title="Permalink to this headline">¶</a></h2>
<p>The following sections will serve as general introduction to IvozProvider:</p>
<div class="toctree-wrapper compound">
<span id="document-intro/about"></span><div class="section" id="about-this-document">
<h3>About this document<a class="headerlink" href="#about-this-document" title="Permalink to this headline">¶</a></h3>
<p>This document describes the process of installation and usage of
IvozProvider, the multi-tenant telephony platform for providers developed
by <a class="reference external" href="http://irontec.com">Irontec</a>.</p>
<p>This should be the starting point for anyone interested in this solution,
both  from the technical point of view and the user one and it&#8217;s divided
in four blocks:</p>
<blockquote>
<div><ul class="simple">
<li>The first block is about <a class="reference internal" href="index.html#concepts"><span class="std std-ref">Basic Concepts</span></a> where each element of the
product and its main function is decscribed.</li>
<li>The second block describes the <a class="reference internal" href="index.html#installation"><span class="std std-ref">Minimum Configuration</span></a> process with a fresh
installed platform, leaving the deep configuration details for the next
block.</li>
<li>The third block goes deeper into the most <a class="reference internal" href="index.html#advanced"><span class="std std-ref">Advanced Configuration</span></a> features like
<strong>trarification, billing, PBX advanced options and every call details</strong>
that were omitted in the previous block.</li>
<li>The fourth and last block describes the <a class="reference internal" href="index.html#security"><span class="std std-ref">Security and Maintenance</span></a> measures that
implements the solution.</li>
</ul>
</div></blockquote>
</div>
<span id="document-intro/getting_help"></span><div class="section" id="getting-help">
<span id="id1"></span><h3>Getting help<a class="headerlink" href="#getting-help" title="Permalink to this headline">¶</a></h3>
<p>IvozProvider is an alive and highly developed project. There are
multiple channels to get information or report bugs:</p>
<ul class="simple">
<li>GitHub: <a class="reference external" href="https://github.com/irontec/ivozprovider">https://github.com/irontec/ivozprovider</a></li>
<li>Users mailing list: <a class="reference external" href="mailto:users&#37;&#52;&#48;lists-ivozprovider&#46;irontec&#46;com">users<span>&#64;</span>lists-ivozprovider<span>&#46;</span>irontec<span>&#46;</span>com</a></li>
<li>Developers mailing list: <a class="reference external" href="mailto:dev&#37;&#52;&#48;lists-ivozprovider&#46;irontec&#46;com">dev<span>&#64;</span>lists-ivozprovider<span>&#46;</span>irontec<span>&#46;</span>com</a></li>
<li>email: <a class="reference external" href="mailto:vozip&#37;&#52;&#48;irontec&#46;com">vozip<span>&#64;</span>irontec<span>&#46;</span>com</a></li>
<li>Twitter: <a class="reference external" href="https://twitter.com/irontec">&#64;irontec</a></li>
<li>IRC Channel <a class="reference external" href="https://webchat.freenode.net/?channels=ivozprovider">#ivozprovider</a> at irc.freenode.net</li>
</ul>
<p>Don&#8217;t hesitate to contact us for any kind of feedback :)</p>
</div>
<span id="document-intro/what_is_ivozprovider"></span><div class="section" id="what-is-ivozprovider">
<h3>What is IvozProvider?<a class="headerlink" href="#what-is-ivozprovider" title="Permalink to this headline">¶</a></h3>
<p>IvozProvider is a <a class="reference internal" href="#operator-oriented"><span class="std std-ref">provider oriented</span></a>
<a class="reference internal" href="#multilevel"><span class="std std-ref">multilevel</span></a> <a class="reference internal" href="#voip"><span class="std std-ref">IP telephony</span></a> solution
<a class="reference internal" href="#exposed"><span class="std std-ref">exposed to the public network</span></a>.</p>
<div class="section" id="ip-telephony">
<span id="voip"></span><h4>IP Telephony<a class="headerlink" href="#ip-telephony" title="Permalink to this headline">¶</a></h4>
<p>IvozProvider supports telephony systems that use <em>Session Initialitation
Protocol</em>, <strong>SIP</strong>, described in <a class="reference external" href="https://tools.ietf.org/html/rfc3261">RFC 3261</a> and any <a class="reference external" href="https://www.packetizer.com/ipmc/sip/standards.html">related RFCs</a> independent of
manufacturers.</p>
<p>This allows total freedom to choose <em>softphones</em>, <em>hardphones</em> and the
rest of elements that interact with IvozProvider, without any kind of
binding with a manufacturer.</p>
<p>Right now, IvozProvider supports the following <strong>transport protocols</strong>
for SIP:</p>
<blockquote>
<div><ul class="simple">
<li>UDP</li>
<li>TCP</li>
<li>TLS</li>
<li>Websockets</li>
</ul>
</div></blockquote>
<p>This last transport protocol described in <a class="reference external" href="https://tools.ietf.org/html/rfc7118">RFC 7118</a> supports web intregrated
softphones, using the <a class="reference external" href="https://webrtc.org/">WebRTC</a> standard allowing
browsers to establish real-time <em>peer-to-peer</em> connections.</p>
<p>The <strong>supported audio codec</strong> list is:</p>
<blockquote>
<div><ul class="simple">
<li>PCMA (<em>alaw</em>)</li>
<li>PCMU (<em>ulaw</em>)</li>
<li>GSM</li>
<li>SpeeX</li>
<li>G.722</li>
<li>G.726</li>
<li>G.729</li>
<li>iLBC</li>
<li><a class="reference external" href="http://opus-codec.org/">OPUS</a></li>
</ul>
</div></blockquote>
</div>
<div class="section" id="multilevel">
<h4>Multilevel<a class="headerlink" href="#multilevel" title="Permalink to this headline">¶</a></h4>
<p>The web portal design of IvozProvider allows <strong>multiple actors within the
same infrastructure</strong>:</p>
<img alt="_images/operator_levels.png" src="_images/operator_levels.png" />
<p>In <a class="reference internal" href="index.html#operation-roles"><span class="std std-ref">Platform roles</span></a> section, the different roles are deeply
described, but to sum up:</p>
<ul class="simple">
<li><strong>God Admin</strong>: The administrator and maintainer of the solution. Provides
access to multiple brand operators.</li>
<li><strong>Brand Operator</strong>: Responsible of giving access, tarificate and bill to
multiple company operators.</li>
<li><strong>Company Operator</strong>: Responsible of its own PBX configuration and to
manage the final platform users.</li>
<li><strong>Users</strong>: The last link of the chain, has SIP credentials and can access
its own portal for custom configurations.</li>
</ul>
<p><strong>Each one</strong> of this roles <strong>has its own portal</strong> that allows them to
fullfill their tasks. Each portal can be customized in the following
ways:</p>
<ul class="simple">
<li>Themes and <em>skins</em> for corporative colours.</li>
<li>Company Logos.</li>
<li>Customized URLs with the Brand or Company domain.</li>
</ul>
</div>
<div class="section" id="provider-oriented">
<span id="operator-oriented"></span><h4>Provider oriented<a class="headerlink" href="#provider-oriented" title="Permalink to this headline">¶</a></h4>
<p>IvozProvider is a telephony solution <strong>designed with horizontal scaling
in mind</strong>, what allows handling a great amount of <strong>traffic and users</strong>
only by increasing the machines and resources of them.</p>
<p>This are the main ideas that makes this product provider oriented:</p>
<ul>
<li><p class="first">Despite the fact that all machine profiles can run in the same host,
whatmakes it easier for the initial testing, each profile of IvozProvider
can be splitted from the rest to make it run in its own machine.</p>
</li>
<li><p class="first">A <strong>distributed installation</strong> allows to distribute the correct amount of
resources to each task, but also:</p>
<blockquote>
<div><ul class="simple">
<li>Geographic distribution of elements to warranty high availability in
caseof CPD failure.</li>
<li>Setup of key elements near the final users, to minimize the communication
latencies.</li>
<li>Horizontal scaling of key profiles to handle hundred of thousands
concurrent calls.</li>
</ul>
</div></blockquote>
</li>
</ul>
<p>The resource consuming elements that limit the service of VoIP solutions
use to be:</p>
<ul class="simple">
<li>Already established calls audio management.</li>
<li>Managing configuration for each company administrator (IVRs, conference
rooms, external call filters, etc.)</li>
<li>Databases of configuration and records.</li>
</ul>
<p>IvozProvider was designed always keeping in mind the <strong>horizontal
scaling</strong> of each of its elements, so it <strong>can handle hundred of
thousands concurrent calls</strong> and what is more important, <strong>adapt the
platform resources to the expected service quality</strong>:</p>
<ul>
<li><p class="first"><strong>Media-relay</strong> servers handle audio frames for the already established
calls:</p>
<blockquote>
<div><ul class="simple">
<li>You can use as many media-relays as you need.</li>
<li>You can join media-relay in groups, and force some companies to use a
group if you want.</li>
<li>You can setup media-relays near the final users, to minimize network
latencies in the calls.</li>
</ul>
</div></blockquote>
</li>
<li><p class="first"><strong>Application servers</strong> are in charge of processing the configurad logics:</p>
<blockquote>
<div><ul class="simple">
<li>They scale horizontally: new Application Serves can be installed and
added to the pool if you feel the need.</li>
<li>Every call is handled by the least busy Appliction Server</li>
<li>By default, there is no static assigment * between Companies and
Application Servers. This way failure of any Application Server is not
critical: the platform will ignore the faulty Application Server while
distributing calls.</li>
</ul>
</div></blockquote>
</li>
</ul>
</div>
<div class="section" id="exposed-to-the-public-network">
<span id="exposed"></span><h4>Exposed to the public network<a class="headerlink" href="#exposed-to-the-public-network" title="Permalink to this headline">¶</a></h4>
<p>As showed in the installation proces, <strong>IvozProvider is designed to serve
users directly from Internet</strong>. Althoughit can be used in local
enviroments, IvozProvider is designed to use public IP addresses for its
services, removing the need of VPN or IPSec tunnels that connect the
infrastructure with the final users</p>
<p>Highlights:</p>
<ul class="simple">
<li>Only the required services will be exposed to Internet.</li>
<li>The unstrusted origins access can be filtered out by integrated firewall</li>
<li>Access from IP addresses or networks can be filtered to avoid any kind of
phishing.</li>
<li>There is also an anti-flood mechanism to avoid short-life Denial of
Service attacks.</li>
<li>Each company concurrent calls can be limited to a fixed amount.</li>
<li>IvozProvider soporta la conexión desde terminales tras
<a class="reference external" href="https://es.wikipedia.org/wiki/Traducci%C3%B3n_de_direcciones_de_red">NAT</a>.</li>
<li>IvozProvider keep track of those NAT windows and keep them alive with
<em>nat-piercing</em> mechanisms.</li>
</ul>
<table class="docutils footnote" frame="void" id="id1" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[*]</td><td>The global administrator can assign Application Servers to companies but
this feature is more designed as a temporal debug and troubleshoot
measure.</td></tr>
</tbody>
</table>
</div>
</div>
<span id="document-intro/what_is_inside"></span><div class="section" id="what-is-inside-ivozprovider">
<h3>What is inside IvozProvider?<a class="headerlink" href="#what-is-inside-ivozprovider" title="Permalink to this headline">¶</a></h3>
<p>IvozProvider uses well-known and stable <a class="reference external" href="https://www.gnu.org/philosophy/free-sw.en.html">Free Software</a> projects to fullfill
the different required task of the platform.</p>
<p>Nothing better than an image to show all the software that its integrated
into IvozProvider:</p>
<img alt="_images/ivozprovider_logos.png" class="align-center" src="_images/ivozprovider_logos.png" />
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">We can not stress enough our gratitude to the developers and communities
of this projects.</p>
</div>
<p>The task of each of this software will be deeply detailed in the block
<a class="reference internal" href="index.html#architecture"><span class="std std-ref">[P] Platform general architecture</span></a>.</p>
</div>
<span id="document-intro/use_cases"></span><div class="section" id="who-should-use-ivozprovider">
<h3>Who should use IvozProvider?<a class="headerlink" href="#who-should-use-ivozprovider" title="Permalink to this headline">¶</a></h3>
<p>IvozProvider is a good option for those insterested in having a telephony
platform that can provide service to <strong>thousands concurrent calls</strong>.</p>
<p>The greatest strengths of IvozProvide can help to decide if the solution
feeds your needs:</p>
<ul class="simple">
<li>VoIP: SIP</li>
<li>Multilevel, multitenant</li>
<li>Horizontal scaling</li>
<li>PseudoSBC: open to Internet</li>
<li>PBX Features</li>
</ul>
<p>The installation process is so simple, that the best way to test if
IvozProvider fullfills yout needs is to test it!</p>
</div>
</div>
</div>
</div>
<div class="toctree-wrapper compound">
<span id="document-architecture/index"></span><div class="section" id="p-platform-general-architecture">
<span id="architecture"></span><h2>[P] Platform general architecture<a class="headerlink" href="#p-platform-general-architecture" title="Permalink to this headline">¶</a></h2>
<div class="section" id="general-diagram">
<h3>General diagram<a class="headerlink" href="#general-diagram" title="Permalink to this headline">¶</a></h3>
<p>Following diagram shows the global architecture of IvozProvider solution,
with all its components:</p>
<img alt="_images/ivozprovider_flows.png" src="_images/ivozprovider_flows.png" />
<p>This is a more conceptual diagram:</p>
<img alt="_images/ivozprovider_esquema_conceptual.png" src="_images/ivozprovider_esquema_conceptual.png" />
</div>
<div class="section" id="sip-signaling-flow">
<span id="signallingflow"></span><h3>SIP signaling flow<a class="headerlink" href="#sip-signaling-flow" title="Permalink to this headline">¶</a></h3>
</div>
<div class="section" id="rtp-audio-flow">
<span id="audioflow"></span><h3>RTP audio flow<a class="headerlink" href="#rtp-audio-flow" title="Permalink to this headline">¶</a></h3>
</div>
<div class="section" id="https-traffic">
<h3>HTTPS traffic<a class="headerlink" href="#https-traffic" title="Permalink to this headline">¶</a></h3>
</div>
<div class="section" id="additional-elements">
<h3>Additional elements<a class="headerlink" href="#additional-elements" title="Permalink to this headline">¶</a></h3>
</div>
<div class="section" id="auxiliar-elements">
<h3>Auxiliar elements<a class="headerlink" href="#auxiliar-elements" title="Permalink to this headline">¶</a></h3>
</div>
</div>
</div>
<div class="toctree-wrapper compound">
<span id="document-operation_roles/index"></span><div class="section" id="platform-roles">
<span id="operation-roles"></span><h2>Platform roles<a class="headerlink" href="#platform-roles" title="Permalink to this headline">¶</a></h2>
<p>IvozProvider is a multilevel role provider solution.</p>
<p>The following images shows the different available levels and the
relation between them:</p>
<img alt="_images/operator_levels1.png" src="_images/operator_levels1.png" />
<p>This section will explain each of the available roles, describing their
responsibilities and more important tasks.</p>
<div class="section" id="global-administator-role">
<h3>Global administator role<a class="headerlink" href="#global-administator-role" title="Permalink to this headline">¶</a></h3>
<p>The global administator role (operator in the image) is usually done by
the installation responsible.</p>
<p>All options and platform features are visible to this role and usually is
in charge of its maintenance.</p>
<p>Their most important task is to <strong>create Brands</strong> and configure them so
they have the enough autonomy to properly use the platform:</p>
<blockquote>
<div><ul class="simple">
<li>Configure their web access.</li>
<li>Configure their brand portal look and feel: themes, colors, etc.</li>
</ul>
</div></blockquote>
<p>Appart from their main task, their global visibility and total access
makes them responsible of:</p>
<ul>
<li><p class="first">Monitor the platform so it keeps always UP &amp; RUNNING</p>
</li>
<li><p class="first">Analyze platform logs to track possible errors.</p>
</li>
<li><p class="first">Polish the security mechanisms to avoid external attacks.</p>
</li>
<li><p class="first">Obtain global statistics of calls audio quality.</p>
</li>
<li><p class="first">Increase the available resources of the platform as long as is needed:</p>
<blockquote>
<div><ul class="simple">
<li>Increasing resources available in a standalone installation</li>
<li>Migrating, whenever required, to a distributed installation with multiple
AS, media relays, etc.</li>
</ul>
</div></blockquote>
</li>
</ul>
<p>To sum up, <strong>this role is the only one that has no limits within the
platform</strong>, thats why <em>God</em> is a term used in multiple places along this
documentation.</p>
<div class="admonition important">
<p class="first admonition-title">Important</p>
<p class="last"><em>This role is responsible of maintain the platform*</em>, configuring
it for the correct behaviour. This role <strong>doesn&#8217;t have any kind
of limit</strong> and <strong>grants access</strong> to the <strong>brand operators</strong>.</p>
</div>
</div>
<div class="section" id="brand-andministator-role">
<h3>Brand andministator role<a class="headerlink" href="#brand-andministator-role" title="Permalink to this headline">¶</a></h3>
<p>Brand operator can access a portal with less sections available compared
to the previous role. The general (God) administrator is in charge of
providing an URL with credentials for its brand portal.</p>
<p>The most important task for brand operator can be managed through this
portal: <strong>create and configure companies so they can work properly</strong>.</p>
<p>Due to brand operators are also resposible of billing their companies and
make sure the external cals are properly setup, it must also manage:</p>
<ul class="simple">
<li>Peering contracts with other IP providers for PSTN interconectivity.</li>
<li>Include all required company information for the billing process.</li>
<li>Pricing plans that will offer to their companies, that will determine how
match they pay for each call.</li>
<li>Setup the routes for each outgoing call types based on their final
destination</li>
<li>Create the invoices for each billing period and send them to their
clients.</li>
</ul>
<p>As you can see, the task of brand operator has little in common with the
global operator, but their importance is vital so the final users can use
all the features includes in IvozProvider</p>
<div class="admonition important" id="brand-responsibilities">
<p class="first admonition-title">Important</p>
<p class="last"><strong>To sum up</strong>, the brand operators <strong>grant access</strong> to the
<strong>company</strong> administrators they serve and <strong>configure the
platform to route, tarificate and bill their calls</strong>.</p>
</div>
</div>
<div class="section" id="company-administator-role">
<h3>Company administator role<a class="headerlink" href="#company-administator-role" title="Permalink to this headline">¶</a></h3>
<p>The company administrator has access to the portal supplied by the brand
operator.</p>
<p>From its point of view, it has a virtual pbx in the cloud that must
configure for its users.</p>
<p>To accomplish that, it&#8217;s required:</p>
<ul>
<li><p class="first">Configure terminals, extensions and users.</p>
</li>
<li><p class="first">Configure the DDI incoming process with the proper logic:</p>
<blockquote>
<div><ul class="simple">
<li>Directly to an user</li>
<li>IVRs</li>
<li>Hunt groups</li>
<li>Faxes</li>
</ul>
</div></blockquote>
</li>
<li><p class="first">Give access to the final users to their web portal, so they can configure
their profile options:</p>
<blockquote>
<div><ul class="simple">
<li>Call forward</li>
<li>Do not disturb</li>
<li>Call waiting</li>
</ul>
</div></blockquote>
</li>
</ul>
<div class="admonition important">
<p class="first admonition-title">Important</p>
<p class="last">To sum up, the company administrators are resposible for
<strong>configuring the telephony system and make use of all the
features available in IvozProvider</strong>.</p>
</div>
</div>
<div class="section" id="final-user-role">
<h3>Final user role<a class="headerlink" href="#final-user-role" title="Permalink to this headline">¶</a></h3>
<p>The final user has two different kinds of credentials, both supplied by
its company administator:</p>
<ul class="simple">
<li>User portal access credetentials</li>
<li>SIP credentials used to register its terminal (or terminals) to IvozProvider</li>
</ul>
<p>Through the user portal, it can browse their call registry and configure:</p>
<blockquote>
<div><ul class="simple">
<li>Call forward</li>
<li>Do not disturb</li>
<li>Call waiting</li>
</ul>
</div></blockquote>
<p>On the other hand, the SIP creadentials allow the users to configure
their terminal (or terminals) to place and receive calls.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The same SIP credentials can be used in multiple devices at the same
time,generating what is known as <em>parallel-forking</em>: whenever a call is
placed to an user, all the active devices will ring so the user can
answer the call from any of them.</p>
</div>
<div class="admonition important">
<p class="first admonition-title">Important</p>
<p class="last">Final users are the ones that use and enjoy all the feature of
IvozProvider</p>
</div>
</div>
</div>
</div>
<div class="toctree-wrapper compound" id="installation">
<span id="document-installation/index"></span><div class="section" id="initial-installation">
<h2>Initial Installation<a class="headerlink" href="#initial-installation" title="Permalink to this headline">¶</a></h2>
<div class="toctree-wrapper compound">
<span id="document-installation/install_types"></span><div class="section" id="installation-types">
<h3>Installation Types<a class="headerlink" href="#installation-types" title="Permalink to this headline">¶</a></h3>
<div class="section" id="distributed-install">
<h4>Distributed Install<a class="headerlink" href="#distributed-install" title="Permalink to this headline">¶</a></h4>
<p>IvozProvider software is designed to run distributed between multiple systems
in what we call profiles:</p>
<p>Each profile is in charge of performing one of the platform functionalities:</p>
<blockquote>
<div><ul class="simple">
<li>Data storage</li>
<li>SIP Proxy</li>
<li>Application Server</li>
<li>Web portal</li>
</ul>
</div></blockquote>
<p>For each of this profiles, there&#8217;s a virtual package that will install all the
required dependencies (see <a class="reference internal" href="index.html#installing-profile-package"><span class="std std-ref">Installing profile package</span></a>).</p>
<p>You can install as many instances as you want for each profile, but take into
account, that while some of them are designed to scale horizontally (for
example: asterisk or media-relays) others will require aditional software so the
systems that have the same profile are syncronized (for example: database
replication or http request balancing).</p>
</div>
<div class="section" id="standalone-install">
<h4>StandAlone Install<a class="headerlink" href="#standalone-install" title="Permalink to this headline">¶</a></h4>
<p>If you want an small installation to make a couple of tests or give a basic
service, we have designed all this configuration so they can work in a single
machine.</p>
<p>We have called this kind of installations as <strong>StandAlone</strong> and we have also
created <a class="reference internal" href="index.html#automatic-iso-cd-image"><span class="std std-ref">Automatic ISO CD image</span></a> so you can install in a couple of minutes.</p>
</div>
</div>
<span id="document-installation/requirements"></span><div class="section" id="minimum-requirements">
<h3>Minimum requirements<a class="headerlink" href="#minimum-requirements" title="Permalink to this headline">¶</a></h3>
<div class="section" id="system-requirements">
<h4>System requirements<a class="headerlink" href="#system-requirements" title="Permalink to this headline">¶</a></h4>
<p>IvozProvider is designed to be installed using Debian GNU/Linux APT package
system.</p>
<div class="admonition important">
<p class="first admonition-title">Important</p>
<p class="last">It&#8217;s recommended to install IvozProvider in a dedicated server
for the platform. Many of the installed software may not work properly with
other pre-installed services (like MySQL or DNS servers).</p>
</div>
<p>For a StandAlone installation, we recommend at least:</p>
<blockquote>
<div><ul class="simple">
<li>4 CPUs (x86_64 or i386)</li>
<li>4 Gb memory</li>
<li>30GB HDD</li>
<li>2 IP Addresses (preferably public)</li>
</ul>
</div></blockquote>
<p>If you&#8217;re not using a <a class="reference internal" href="index.html#automatic-iso-cd-image"><span class="std std-ref">Automatic ISO CD image</span></a> you will also need:</p>
<blockquote>
<div><ul class="simple">
<li>Debian Jessie 8.0 base install</li>
<li>Internet access</li>
</ul>
</div></blockquote>
</div>
</div>
<span id="document-installation/debian_install"></span><div class="section" id="debian-packages-install">
<h3>Debian packages install<a class="headerlink" href="#debian-packages-install" title="Permalink to this headline">¶</a></h3>
<p>IvozProvider is designed to be installed and updated using Debian packages.
More exactly, the current release is ready to be installed on
<a class="reference external" href="https://www.debian.org/releases/jessie">Debian Jessie 8</a>.</p>
<p>It&#8217;s recommended to use one of the <a class="reference external" href="https://www.debian.org/releases/jessie/installmanual">official installation guides</a> to install the minimum
base system. The rest of required  dependencies will be installed automatically
with IvozProvider meta packages.</p>
<p>No matter if you are installing a  <a class="reference internal" href="index.html#standalone-install"><span class="std std-ref">StandAlone Install</span></a> or a
<a class="reference internal" href="index.html#distributed-install"><span class="std std-ref">Distributed Install</span></a>, it&#8217;s required to configure Irontec debian
repositories.</p>
<div class="section" id="apt-repository-configuration">
<h4>APT Repository configuration<a class="headerlink" href="#apt-repository-configuration" title="Permalink to this headline">¶</a></h4>
<p>Right now, two different repositories are used for the latest IvozProvider
release (called oasis) and it&#8217;s frontend Klear release (called chloe).</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="go">cd /etc/apt/sources.list.d</span>
<span class="go">echo deb http://packages.irontec.com/debian oasis main extra &gt; ivozprovider.list</span>
<span class="go">echo deb http://packages.irontec.com/debian chloe main &gt; klear.list</span>
</pre></div>
</div>
<p>Optionally, we can add the repository key to check signed packages:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="go">wget http://packages.irontec.com/public.key -q -O - | apt-key add -</span>
</pre></div>
</div>
</div>
<div class="section" id="installing-profile-package">
<h4>Installing profile package<a class="headerlink" href="#installing-profile-package" title="Permalink to this headline">¶</a></h4>
<p>Once the repositories are configured, it will be required to select the proper
metapackage depending on the type of installation.</p>
<ul>
<li><dl class="first docutils">
<dt>For a <a class="reference internal" href="index.html#standalone-install"><span class="std std-ref">StandAlone Install</span></a>:</dt>
<dd><ul class="first last simple">
<li>ivozprovider</li>
</ul>
</dd>
</dl>
</li>
<li><p class="first">For a <a class="reference internal" href="index.html#distributed-install"><span class="std std-ref">Distributed Install</span></a>: one of the profile packages depending on the
role the machine will perform.</p>
<blockquote>
<div><ul class="simple">
<li>ivozprovider-profile-data</li>
<li>ivozprovider-profile-proxy</li>
<li>ivozprovider-profile-portal</li>
<li>ivozprovider-profile-as</li>
</ul>
</div></blockquote>
</li>
</ul>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="go">apt-get update</span>
<span class="go">apt-get install ivozprovider</span>
</pre></div>
</div>
</div>
<div class="section" id="finish-the-installation">
<h4>Finish the installation<a class="headerlink" href="#finish-the-installation" title="Permalink to this headline">¶</a></h4>
<p>Distributed installation require a couple manual configuration based on the
roles that are performing. Check <a class="reference external" href="http://github.com/irontec/ivozprovider">finishing role configuration</a> for more information.</p>
<p>Standalone installation have a menu that can be used to configure the basic
services used in IvozProvider. Most of the services are automatically configured
to work in the same machine with the default values.</p>
<p>This menu allows:</p>
<ul class="simple">
<li>Configure IP addresses for SIP proxies</li>
<li>Default platform language</li>
<li>Administrator MySQL database password</li>
</ul>
<p>It&#8217;s possible to change any of this values anytime by running:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="go">dpkg-reconfigure ivozprovider</span>
</pre></div>
</div>
</div>
</div>
<span id="document-installation/cd_install"></span><div class="section" id="automatic-iso-cd-image">
<h3>Automatic ISO CD image<a class="headerlink" href="#automatic-iso-cd-image" title="Permalink to this headline">¶</a></h3>
<p>You can download one of the <a class="reference external" href="https://github.com/irontec/ivozprovider">IvozProvider Automatic ISO CD images</a> (generated using
<a class="reference external" href="https://wiki.debian.org/Simple-CDD">simplecdd</a>) in stable or nighly versions:</p>
<div class="admonition important">
<p class="first admonition-title">Important</p>
<p class="last">IMPORTANT: Automatic install CDs will format target machine disk!</p>
</div>
<ul class="simple">
<li>Configure the target machine to boot from CD. It will display the Debian
GNU/Linux installation menu.</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">You can use graphic installation if you prefer, but the following
screenshots show the standard installation.</p>
</div>
<img alt="_images/installcd-intro.png" src="_images/installcd-intro.png" />
<ul class="simple">
<li>Choose installation language:</li>
</ul>
<img alt="_images/installcd-language.png" src="_images/installcd-language.png" />
<ul class="simple">
<li>Choose location:</li>
</ul>
<img alt="_images/installcd-location.png" src="_images/installcd-location.png" />
<ul class="simple">
<li>Choose date and time configuration:</li>
</ul>
<img alt="_images/installcd-clock.png" src="_images/installcd-clock.png" />
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">At this point, a generic network configuration and disk partitioning
will be performed, and also a installation of base system.</p>
</div>
<ul class="simple">
<li>Configure IvozProvider:</li>
</ul>
<img alt="_images/installcd-ivozmenu.png" src="_images/installcd-ivozmenu.png" />
<p>As mentioned in <a class="reference internal" href="index.html#minimum-requirements"><span class="std std-ref">Minimum requirements</span></a> is required at least two IP
addresses for User and Trunk SIP proxies.</p>
<p>You can set its addresses right now and configure the interfaces properly when
the system is fully installed. This menu can be displayed anytime after the
installation.</p>
<img alt="_images/installcd-proxyaddr.png" src="_images/installcd-proxyaddr.png" />
<p>You can also configure default root MySQL password right now.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If you don&#8217;t configure MySQL password, default password will be used
(changeme). You can still change it later.</p>
</div>
<img alt="_images/installcd-mysql.png" src="_images/installcd-mysql.png" />
<p>And default language for portals:</p>
<img alt="_images/installcd-portallang.png" src="_images/installcd-portallang.png" />
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">It is not require to configure all settings during initial
installation. In case any setting has been left without configuration a
warning dialog will be displayed.</p>
</div>
<img alt="_images/installcd-warning.png" src="_images/installcd-warning.png" />
<p>At last, select where the GRUB boot loader will be installed.</p>
<img alt="_images/installcd-grub.png" src="_images/installcd-grub.png" />
<p>After the reboot, you are ready to access using the web portals!</p>
</div>
</div>
</div>
</div>
<div class="toctree-wrapper compound">
<span id="document-internal_calls/index"></span><div class="section" id="make-an-internal-call">
<h2>Make an internal call<a class="headerlink" href="#make-an-internal-call" title="Permalink to this headline">¶</a></h2>
<p>The goal of this block will be to configure IvozProvider in order to make
internal calls, using as the starting point the base installation described
in the previous step.</p>
<p>In order to archive a call between Alice and Bob, we have to do some task in
the three configuration levels described in <a class="reference internal" href="index.html#operation-roles"><span class="std std-ref">Platform roles</span></a>, and that
is why we have ordered the index in this blocks:</p>
<div class="toctree-wrapper compound">
<span id="document-internal_calls/god_portal"></span><div class="section" id="main-management">
<h3>Main Management<a class="headerlink" href="#main-management" title="Permalink to this headline">¶</a></h3>
<div class="admonition important">
<p class="first admonition-title">Important</p>
<p class="last">Any of the 2 Public IP addresses configured during the
installation will work to acces the web portal. Default credentials are
<em>admin / changeme</em>.</p>
</div>
<p>In this section will reference global administrator configuration options,
avaible in the menu (<strong>Main management</strong>) of the web portal (only visible to
God Admins):</p>
<img alt="_images/bloque_god.png" class="align-center" src="_images/bloque_god.png" />
<div class="section" id="custom-installation-configuration">
<h4>Custom installation configuration<a class="headerlink" href="#custom-installation-configuration" title="Permalink to this headline">¶</a></h4>
<p>During the install process two IP addresses will be requested in order to run
the following two processes:</p>
<div class="section" id="users-sip-proxy">
<span id="proxyusers"></span><h5>Users SIP Proxy<a class="headerlink" href="#users-sip-proxy" title="Permalink to this headline">¶</a></h5>
<p>This is the SIP proxy exposed to the external world where users register their
terminals.</p>
<p>The value displayed in the section <strong>Proxy users</strong> will show the IP address
entered during the installation process.</p>
<img alt="_images/proxyusers.png" src="_images/proxyusers.png" />
</div>
<div class="section" id="providers-sip-proxy">
<h5>Providers SIP proxy<a class="headerlink" href="#providers-sip-proxy" title="Permalink to this headline">¶</a></h5>
<p>This is the SIP proxy exposed to the external world in charge of connecting
the provider that brand aministrators will configure for <em>peering</em>.</p>
<p>The value displayed in the section <strong>Proxy trunk</strong> will show the IP address
entered during the installation process.</p>
<img alt="_images/proxytrunks.png" src="_images/proxytrunks.png" />
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Only the IP address will be entered as the port will be always 5060
(5061 for SIP over TLS).</p>
</div>
<div class="admonition danger">
<p class="first admonition-title">Danger</p>
<p class="last">This 2 values can be changed from the portal, but they must always
have the same IP address that proxy process listen to requests.</p>
</div>
</div>
</div>
<div class="section" id="standard-global-configuration">
<h4>Standard global configuration<a class="headerlink" href="#standard-global-configuration" title="Permalink to this headline">¶</a></h4>
<p>The installation process includes other global values that are the same in
any standalone IvozProvider installation and can also be checked from the
web interface.</p>
<div class="section" id="application-servers">
<h5>Application Servers<a class="headerlink" href="#application-servers" title="Permalink to this headline">¶</a></h5>
<p>The section <strong>Application Servers</strong> will list the IP address where the existing
Asterisk processes will listen for request, and like previously mentioned,
can scale horizontaly to adapt the platform for the required load.</p>
<p>Contrary to the Proxies, Asterisk is not exposed to the external world, so
for a standalone installation there will only be one listening at 127.0.0.1.</p>
<img alt="_images/app_servers.png" src="_images/app_servers.png" />
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The listening port will not be displayed in the field because it will
always be 6060 (UDP).</p>
</div>
<div class="admonition important">
<p class="first admonition-title">Important</p>
<p class="last">As soon as another Application Server is added, the proxies will
try to balance load using it. If no response is received from added
Application server, it will be disabled automatically.</p>
</div>
</div>
<div class="section" id="media-relay">
<h5>Media relay<a class="headerlink" href="#media-relay" title="Permalink to this headline">¶</a></h5>
<p>Media relays are in charge of bridging RTP traffic of established calls. Like
the Application Servers, they can scale horizontally as much as required.</p>
<p>Media relays are organized in groups so they can be assigned to a company. Each
element of the group has a <strong>metric</strong> that allows non-equal load balancing
within the same group (i.e. media-relay1 metric 1; media-relay2 metric 2:
the second media relay will handle two times the calls than the first one).</p>
<div class="admonition hint">
<p class="first admonition-title">Hint</p>
<p class="last">The static assigment of media relay groups is not the common practice
but allow us to assign strategic resources to companies that need a warranted
service. The most common usage of this <strong>groups of media relays</strong> is to
place them near the geographic area of the company (usually far from the
rest of the platform systems) in order to reduce <strong>latencies</strong> in their
conversations.</p>
</div>
<p>In a standalone installation, only one media relay group will be exist:</p>
<img alt="_images/media_relay_groups.png" src="_images/media_relay_groups.png" />
<p>By default this group only has a media server:</p>
<img alt="_images/media_relays.png" src="_images/media_relays.png" />
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The address displayed is the control socket, not the SDP address that
will be included during SIP negociation. By default this alone media-relay
will share the same IP address that the User&#8217;s SIP proxy.</p>
</div>
</div>
<div class="section" id="sip-domains">
<span id="god-sipdomains"></span><h5>SIP Domains<a class="headerlink" href="#sip-domains" title="Permalink to this headline">¶</a></h5>
<p>The section <strong>Domains</strong> will display the SIP domains that points to our two
public IP addresses.</p>
<ul class="simple">
<li>Users SIP Proxy IP address</li>
<li>Trunks SIP Proxy IP address</li>
</ul>
<p>After the initial installation, there will be two domains, one for each address:</p>
<img alt="_images/domain_list_local.png" src="_images/domain_list_local.png" />
<p>This domains will be used internally by a builtin DNS server included in the
solution.</p>
<div class="admonition attention">
<p class="first admonition-title">Attention</p>
<p class="last">As mentioned in the section <a class="reference internal" href="index.html#domain-per-company"><span class="std std-ref">Company SIP Domain</span></a>, each
company will require a DNS pointing to the users SIP proxy. Once configured,
the domain will be displayed in this list so global administrator can check
what domains are registered for each company.</p>
</div>
</div>
</div>
<div class="section" id="emulate-the-demo-brand">
<h4>Emulate the Demo brand<a class="headerlink" href="#emulate-the-demo-brand" title="Permalink to this headline">¶</a></h4>
<p>After the initial installation, the platform will have an already created brand
called DemoBrand, that will be used for our goal: to have 2 telephones registered
that can call each other.</p>
<p>Before going to the next section, is quite important to understand how the
<strong>emulation</strong> works.</p>
<ul class="simple">
<li>As global operator, you have access to the menu <strong>Main management</strong> only
visible to <em>God</em> administators.</li>
<li>Apart from that menu, you will also have access to the <strong>Brand configuration</strong>
and <strong>Company configuration</strong> that will look more or less like this:</li>
</ul>
<img alt="_images/emular_marca_prev.png" class="align-center" src="_images/emular_marca_prev.png" />
<ul class="simple">
<li>Check following button</li>
</ul>
<img alt="_images/emular_marca.png" class="align-center" src="_images/emular_marca.png" />
<ul class="simple">
<li>When pressed, a popup will be displayed:</li>
</ul>
<img alt="_images/emular_marca2.png" class="align-center" src="_images/emular_marca2.png" />
<ul class="simple">
<li>After selecting the DemoBrand brand, the icon will change and shows the
emulted brand:</li>
</ul>
<img alt="_images/emular_marca3.png" class="align-center" src="_images/emular_marca3.png" />
<ul class="simple">
<li>The upper right corner of the portal will also display the brand that is being
emulted:</li>
</ul>
<img alt="_images/emular_marca4.png" class="align-center" src="_images/emular_marca4.png" />
<div class="section" id="what-emulation-means">
<h5>What emulation means<a class="headerlink" href="#what-emulation-means" title="Permalink to this headline">¶</a></h5>
<p>Basically, that <strong>everything in the menu &#8216;Brand configuration&#8217; will be relative
to the chosen brand</strong> and is <strong>exactly</strong> the same menu entries that the brand
operator will see using its brand portal.</p>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p class="last">Ok, ok. maybe exactly is not totally accurate. The global operator is
able to see some fields in some screens that other admins cann&#8217;t (i.e. On
Company edit screen, fields like &#8216;Media relays&#8217; or &#8216;Application server&#8217; are
only configurable by the global operator.</p>
</div>
</div>
</div>
</div>
<span id="document-internal_calls/brand_portal"></span><div class="section" id="brand-configuration">
<h3>Brand Configuration<a class="headerlink" href="#brand-configuration" title="Permalink to this headline">¶</a></h3>
<p>We need that the default DemoBrand have a company with at least 2 users. In
order to archive this we will require little configuration in this section.</p>
<p>In fact, if we check <strong>Companies</strong> in the brand menu, we&#8217;ll discover that there
is already an existing <em>DemoCompany</em> that we can use to fulfill our desired
goal :)</p>
<img alt="_images/company_list.png" src="_images/company_list.png" />
<p>Only a thing is required to configure for this company, marked as edit in the
previous image.</p>
<div class="section" id="company-sip-domain">
<span id="domain-per-company"></span><h4>Company SIP Domain<a class="headerlink" href="#company-sip-domain" title="Permalink to this headline">¶</a></h4>
<p>As mentioned in the previous section, is <strong>required</strong> that each of the companies
have a public domain that resolves to the configured IP address for
<a class="reference internal" href="index.html#proxyusers"><span class="std std-ref">Users SIP Proxy</span></a>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">DNS register can be type A (supported by all the hardphones/softphones
) or even NAPTR+SRV.</p>
</div>
<p>Once the domain has been configured (by means that are out of scope of this
document), it will be enought to write it in our company configuration:</p>
<img alt="_images/set_domain.png" src="_images/set_domain.png" />
<p>Once the company has been saved, the domain will be also displayed in the list
<a class="reference internal" href="index.html#god-sipdomains"><span class="std std-ref">previously mentioned</span></a>:</p>
<img alt="_images/domain_list.png" src="_images/domain_list.png" />
<div class="admonition attention">
<p class="first admonition-title">Attention</p>
<p class="last">It&#8217;s important to understand this block. Wihout a DNS domain
pointing to our users proxy IP address, everything will fail.</p>
</div>
<p>This is a good sign for the domain we have configured right now, replacing the
10.10.3.10 with the public address we have used to configure <a class="reference internal" href="index.html#proxyusers"><span class="std std-ref">Users SIP Proxy</span></a>.</p>
<img alt="_images/dominio_bien_configurado.png" src="_images/dominio_bien_configurado.png" />
<div class="admonition danger">
<p class="first admonition-title">Danger</p>
<p class="last">Have we stressed enough that without a properly configured DNS
pointing to the Users proxy IP address nothing will work?</p>
</div>
<div class="section" id="i-have-no-time-for-a-dns-registry">
<span id="dnshack"></span><h5>I have no time for a DNS registry<a class="headerlink" href="#i-have-no-time-for-a-dns-registry" title="Permalink to this headline">¶</a></h5>
<p>Everything we have said is true: as we create new brands and brands create new
companies, each of them will need a DNS registry.</p>
<p>But the first company of the platform is quite special and can take over the IP
address of the proxy to use it as a domain:</p>
<img alt="_images/fake_domain.png" src="_images/fake_domain.png" />
<p>Although it is not a domain, but being used like it was, it will be displayed
in Domain section:</p>
<img alt="_images/fake_domain2.png" src="_images/fake_domain2.png" />
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p class="last">It’s important to understand the this trick is only valid for the first
company of the platform ;)</p>
</div>
</div>
</div>
<div class="section" id="emulate-demo-company">
<span id="emulate-company"></span><h4>Emulate Demo company<a class="headerlink" href="#emulate-demo-company" title="Permalink to this headline">¶</a></h4>
<p>The company emulation process is the same as the brand emulation, with the
difference that it filters the block ‘Company Configuration’ insted of
‘Brand Configuration’.</p>
<img alt="_images/emulate_company.png" class="align-center" src="_images/emulate_company.png" />
<img alt="_images/emulate_company2.png" class="align-center" src="_images/emulate_company2.png" />
<p>Once the company has been emulated, the top right corner of the portal will
show that we are in the right path :)</p>
<img alt="_images/emular_empresa.png" class="align-center" src="_images/emular_empresa.png" />
</div>
</div>
<span id="document-internal_calls/company_portal"></span><div class="section" id="company-configuration">
<h3>Company Configuration<a class="headerlink" href="#company-configuration" title="Permalink to this headline">¶</a></h3>
<p>We&#8217;re close to make our fist call in our fresh installed IvozProvider, there
are only 6 steps to configure in our DemoCompany company.</p>
<ul class="simple">
<li>2 terminals</li>
<li>2 extensions</li>
<li>2 users</li>
</ul>
<div class="section" id="creating-terminals">
<h4>Creating Terminals<a class="headerlink" href="#creating-terminals" title="Permalink to this headline">¶</a></h4>
<p>Go to the terminal section and... voilà! We already have 2 terminals created:</p>
<img alt="_images/terminals.png" src="_images/terminals.png" />
</div>
<div class="section" id="creating-extensions">
<h4>Creating Extensions<a class="headerlink" href="#creating-extensions" title="Permalink to this headline">¶</a></h4>
<p>Then we go to extensions, just to check that we have 2 extensions already
created for us:</p>
<img alt="_images/extensions.png" src="_images/extensions.png" />
<p>Nothing more to do in this section, let&#8217;s go the next one!</p>
</div>
<div class="section" id="creating-users">
<h4>Creating Users<a class="headerlink" href="#creating-users" title="Permalink to this headline">¶</a></h4>
<p>As expected, we also have 2 created users:</p>
<img alt="_images/users.png" src="_images/users.png" />
<p>At this point, we have everthing ready make a call between this two users:
Alice and Bob.</p>
</div>
</div>
<span id="document-internal_calls/configure_sipuacs"></span><div class="section" id="sip-terminal-configuration">
<h3>SIP Terminal configuration<a class="headerlink" href="#sip-terminal-configuration" title="Permalink to this headline">¶</a></h3>
<p>The last thing we need is 2 SIP terminals (hardphones, softphones or even
mobile applications) and configure them as follows:</p>
<p><strong>ALICE</strong></p>
<ul class="simple">
<li><strong>User</strong>: alice</li>
<li><strong>Password</strong>: alice</li>
<li><strong>Domain</strong>: users.democompany.com (or the IP if we are using <a class="reference internal" href="index.html#dnshack"><span class="std std-ref">the DNS
trick</span></a>)</li>
</ul>
<p><strong>BOB</strong></p>
<ul class="simple">
<li><strong>User</strong>: bob</li>
<li><strong>Password</strong>: bob</li>
<li><strong>Domain</strong>: users.democompany.com (or the IP if we are using <a class="reference internal" href="index.html#dnshack"><span class="std std-ref">the DNS
trick</span></a>)</li>
</ul>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p class="last">Sometimes the user and domain is configured in a single option. In this
case we should enter <a class="reference external" href="mailto:alice&#37;&#52;&#48;users&#46;democompany&#46;com">alice<span>&#64;</span>users<span>&#46;</span>democompany<span>&#46;</span>com</a> and <a class="reference external" href="mailto:bob&#37;&#52;&#48;users&#46;democompany&#46;com">bob<span>&#64;</span>users<span>&#46;</span>democompany<span>&#46;</span>com</a>
(or the IP if we are using <a class="reference internal" href="index.html#dnshack"><span class="std std-ref">the DNS trick</span></a>)</p>
</div>
<p>After configuring the terminals, Alices should be able to call Bob only by
dialing 102 in her terminal.</p>
</div>
</div>
</div>
<span id="document-external_incoming_calls/index"></span><div class="section" id="receive-external-calls">
<h2>Receive external calls<a class="headerlink" href="#receive-external-calls" title="Permalink to this headline">¶</a></h2>
<p>The goal of this block will be configure IvozProvider to receive incoming
external calls.</p>
<p>In order tho archive this, this steps will be followed:</p>
<div class="toctree-wrapper compound">
<span id="document-external_incoming_calls/numeric_transformations"></span><div class="section" id="numeric-transformations">
<span id="id1"></span><h3>Numeric transformations<a class="headerlink" href="#numeric-transformations" title="Permalink to this headline">¶</a></h3>
<div class="section" id="concept">
<h4>Concept<a class="headerlink" href="#concept" title="Permalink to this headline">¶</a></h4>
<p><strong>IvozProvider</strong> is designed to provide service <strong>anywhere in the planet</strong>, not
only the original country where the platform is installed.</p>
<p>A very important contept to archive this goal is the numeric transformation,
that <strong>adapts the different number format systems of the countries of the world</strong>
defined in <a class="reference external" href="https://www.itu.int/rec/T-REC-E.164/es">E.164</a> <strong>to a neutral
format</strong>.</p>
<p>The section that allows the brand operator to configure all the <strong>numeric
transformations</strong> is:</p>
<img alt="_images/numeric_transformations_section.png" class="align-center" src="_images/numeric_transformations_section.png" />
<p>There are two different transformation scenarios:</p>
<div class="section" id="incoming-transformations">
<h5>Incoming transformations<a class="headerlink" href="#incoming-transformations" title="Permalink to this headline">¶</a></h5>
<p>When a new call is received in IvozProvider matching a provider that has been
configured for <em>peering</em>, we must adapt the numbers that make reference to:</p>
<ul class="simple">
<li>Origin of the call</li>
<li>Destination of the call</li>
</ul>
<p>Depending on the country of the provider, the international numbers will have
a format or another. In this case, the spanish provider will use, for example:</p>
<ul class="simple">
<li>00 + 33 + number belonging to France</li>
<li>It&#8217;s possible that the international numbers came without the 00 code.</li>
<li>It&#8217;s possible that, if the call comes from the same country that the provider,
the number comes without the calling code (911234567 insted of 00 + 34 +
911234567 for Spain).</li>
</ul>
<p>For an Ukranian provider, that doesn&#8217;t use the 00 as international code:</p>
<ul class="simple">
<li>It will use 810 + 33 + number belonging to France.</li>
<li>It&#8217;s possible that even part of the internation code (00 in most of the
countries of the world) the provider use specific codes as prefix.</li>
</ul>
<p>The goal of the incoming transformation is that, no matter what numeric system
the provider uses, the number will end in a general and common format.</p>
<div class="admonition important" id="e164">
<p class="first admonition-title">Important</p>
<p class="last">This common format is usually called E.164 and shows the numbers
without internation code, but with country calling code: i.e. 34911234567</p>
</div>
</div>
<div class="section" id="outgoing-transformations">
<h5>Outgoing transformations<a class="headerlink" href="#outgoing-transformations" title="Permalink to this headline">¶</a></h5>
<p>In the same whay the origin and destination must adaptat incoming numbers, it
will be required to adapt outgoing dialed numbers to properly work with each
of the providers that will route our call.</p>
<p>For example, for a number with spanish number system:</p>
<ul class="simple">
<li><em>Spanish provider</em>: Destination will come in E164 (34911234567) and for this
provider, we can remove the calling code (will understand it belongs to
its country), so the number sent to them will be 911234567.</li>
<li><em>French provider</em>: The destination will come in E164 (34911234567) and we must
add the international code for France, so the number sent to them will be
0034911234567.</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">To sum up, we aim to send the origin and destination in the format the
provider is expecting.</p>
</div>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p class="last">Numeric transformation uses <a class="reference external" href="https://es.wikipedia.org/wiki/Expresi%C3%B3n_regular">simple regular expresions</a> to describe the
changes done to the numbers. You can find multiple tutorials on net with the
basic regular expression format.</p>
</div>
</div>
</div>
<div class="section" id="national-provider-transformations">
<h4>&#8216;National provider&#8217; transformations<a class="headerlink" href="#national-provider-transformations" title="Permalink to this headline">¶</a></h4>
<p>IvozProvider comes with an automatic transformation rules generator that fits
with most of the countries.</p>
<p>In order to create a new set of transformations for spanish provider:</p>
<img alt="_images/numeric_transformations_auto.png" class="align-center" src="_images/numeric_transformations_auto.png" />
<p>The rules that has been auto-created will transform the numbers for spanish
providers that follow this rules:</p>
<ul class="simple">
<li>A spanish number: Neither international nor calling code (34).</li>
<li>Not a spanish number: International code (00) and calling code (34).</li>
</ul>
<p>The numeric transformation <em>sets</em> must be assigned to <strong>Peering Contracts</strong>, as
shown in the following section. This <em>set</em> can be shared by multiple spanish
providers.</p>
<p>Let&#8217;s check this <em>set</em> to understand what transformation rule does:</p>
<img alt="_images/numeric_transformations.png" src="_images/numeric_transformations.png" />
<div class="admonition attention">
<p class="first admonition-title">Attention</p>
<p class="last">The automatic rule generation will create 8 common rules based on
the given parameters. This rules can be edited later to match the provider
requirements.</p>
</div>
<div class="section" id="spanish-incoming-transformation">
<h5>Spanish incoming transformation<a class="headerlink" href="#spanish-incoming-transformation" title="Permalink to this headline">¶</a></h5>
<p>Displayed in blue in the previous image:</p>
<ul class="simple">
<li>Left called/destination</li>
<li>Right callee/origin</li>
</ul>
<p>The same rules will be applied for the origin and destination:</p>
<img alt="_images/numeric_transformations2.png" src="_images/numeric_transformations2.png" />
<ul>
<li><p class="first">The <strong>metric</strong> field will be used to order the rules (smaller first).</p>
<blockquote>
<div><ul class="simple">
<li>If a rule doesnt <em>match</em>, the next rule is evaluated.</li>
<li>If a rule <em>matches</em>, no more rules are evaluated.</li>
<li>If no rule <em>matches</em>, no change is applied.</li>
</ul>
</div></blockquote>
</li>
<li><p class="first">The <strong>Search</strong> field is evaluated agains the number (depending of the
tranformation type it will be destination or origin).</p>
<blockquote>
<div><ul class="simple">
<li>Metric 1: Starting with (^) 00 or &#8216;+&#8217;, followed by a digit between 1 and 9
and only digits between 0 and 9 until the end ($).</li>
<li>Metric 2: Starting with a digit bewteen 1 and 9, followed by eight digits
between 0 and 9 until the end($).</li>
</ul>
</div></blockquote>
</li>
<li><p class="first">The <strong>Replace</strong> field will use the capture groups that matched the Search
field (displayed between brackets, 1 for the first one, 2 for the second
one, and so on) to determine how the number will end.</p>
<blockquote>
<div><ul class="simple">
<li>Metric 1: The number will be converted just to the second capture (2)</li>
<li>Metric 2: The number will be converted to the first capture with 34 prefix</li>
</ul>
</div></blockquote>
</li>
<li><p class="first">Or <em>in other words</em>:</p>
<blockquote>
<div><ul class="simple">
<li>Metric 1: Strip the international code (00 or &#8216;+&#8217;)</li>
<li>Metric 2: Add 34 to spanish numbers that comes without calling code.</li>
</ul>
</div></blockquote>
</li>
</ul>
</div>
<div class="section" id="spanish-outgoing-transformation">
<h5>Spanish outgoing transformation<a class="headerlink" href="#spanish-outgoing-transformation" title="Permalink to this headline">¶</a></h5>
<img alt="_images/numeric_transformations3.png" src="_images/numeric_transformations3.png" />
<p>Following the same logic, this 2 rules make the change of the outgoig external
destination numbers:</p>
<ul class="simple">
<li>Metric 1: If the number starts with 34 prefix, remove it. This converts
E.164 spanish numbers to national format.</li>
<li>Metric 2: If the number doesn&#8217;t start with 34 prefix, add 00. This converts
E.164 international numbers to spanish international numbers.</li>
</ul>
<div class="admonition attention">
<p class="first admonition-title">Attention</p>
<p class="last"><strong>To sum up</strong>: numeric tranformation can adapt origin and
destination numbers to E.164 for the platform, and to providers expected
formats, based on regular expresions and metric that can be grouped in <em>sets</em>
to be shared between multiple <strong>Peering Contracts</strong>.</p>
</div>
</div>
</div>
</div>
<span id="document-external_incoming_calls/peering_contracts"></span><div class="section" id="configuring-a-peering-contract">
<span id="peering-contracts"></span><h3>Configuring a Peering Contract<a class="headerlink" href="#configuring-a-peering-contract" title="Permalink to this headline">¶</a></h3>
<p>We understand a <strong>Peering contract</strong> the agreeming between a <strong>Brand Operator</strong>
and a VoIP Provider to make and receive calls.</p>
<p>IvozProvider is ready to integrate with IP providers created on the secteion
<strong>Perring contracts</strong>:</p>
<img alt="_images/peeringcontract_section.png" class="align-center" src="_images/peeringcontract_section.png" />
<div class="section" id="peering-contract-basic-data">
<h4>Peering contract Basic data<a class="headerlink" href="#peering-contract-basic-data" title="Permalink to this headline">¶</a></h4>
<p>These are the basic information of a Peering contract:</p>
<img alt="_images/peeringcontract.png" class="align-center" src="_images/peeringcontract.png" />
<p>If we edit it, well see something like this:</p>
<img alt="_images/peeringcontract_edit.png" class="align-center" src="_images/peeringcontract_edit.png" />
<dl class="glossary docutils">
<dt id="term-name">Name</dt>
<dd>Used to reference this Peering contract.</dd>
<dt id="term-description">Description</dt>
<dd>Optional field with any required extra information.</dd>
<dt id="term-numeric-transformation">Numeric Transformation</dt>
<dd>Transformation that will be applied to the origin and destination of the
incoming and outgoing numbers that use this Peering contact
(see <a class="reference internal" href="index.html#numeric-transformations"><span class="std std-ref">Numeric transformations</span></a>).</dd>
<dt id="term-external-tarification">External tarification</dt>
<dd>This setting requires the external tarification module and allows
tarification on special numbers. This module is not standard so don&#8217;t
hesitate in <cite>contact us &lt;getting_help&gt;</cite> if you are interested.</dd>
</dl>
<div class="admonition important">
<p class="first admonition-title">Important</p>
<p class="last">Fields marked with a red start are mandatory.</p>
</div>
</div>
<div class="section" id="peer-servers">
<h4>Peer Servers<a class="headerlink" href="#peer-servers" title="Permalink to this headline">¶</a></h4>
<p>A <strong>Peer Server</strong> is a SIP server associated to an IP Provider.
In order to add some Peer Servers for the Peer Contract that
have just created, we only have to use the following section:</p>
<img alt="_images/peerservers.png" class="align-center" src="_images/peerservers.png" />
<p>As displayed by the zero counter, no Peer Serve has been created yet:</p>
<img alt="_images/peerservers_add.png" class="align-center" src="_images/peerservers_add.png" />
<dl class="glossary docutils">
<dt id="term-4">Name</dt>
<dd>Used to identify this Peer Server</dd>
<dt id="term-5">Description</dt>
<dd>Optional field with any required extra information.</dd>
<dt id="term-sip-proxy">SIP Proxy</dt>
<dd>IP address (or DNS registry) of the Peer Server. You can also specify
a port if it&#8217;s different from 5060.</dd>
<dt id="term-uri-scheme">URI Scheme</dt>
<dd>Supported schemes are sip and sips. Use &#8216;sip&#8217; in case of doubt.</dd>
<dt id="term-transport">Transport</dt>
<dd>Supported transport protocols. Use &#8216;udp&#8217; in case of doubt.</dd>
<dt id="term-outbound-proxy">Outbound Proxy</dt>
<dd>Usually this is left empty. It can be filled with the IP address of the
<strong>SIP Proxy</strong> domain (to avoid DNS resolution, but keeping the domain
in the SIP messages). It works like a web proxy: instead of sending the
SIP messages to destination <strong>SIP Proxy</strong>, they will be sent to the
IP:PORT of this field.</dd>
<dt id="term-requires-authentication">Requires Authentication</dt>
<dd>Some Peering contracts validate our platform by IP, others require
each session that we want to establish. For this last case, this section
allows to configure user and password for this authentication.</dd>
<dt id="term-call-origin-header">Call Origin Header</dt>
<dd>Some Providers get origin from SIP From header. Others use the From
header for accounting and need extra headers to identify the origin.
In case of doubt leave <strong>PAI</strong> checked.</dd>
<dt id="term-r-uri-transformations-before-numeric-transformations">R-URI Transformations before numeric transformations</dt>
<dd>This setting allow static changes to the destination of the calls before
applying numeric transformation rules mentioned in
<a class="reference internal" href="index.html#numeric-transformations"><span class="std std-ref">Numeric transformations</span></a>. Some digits can be stripped from the
begining, add a prefix, or even, add extra parameters to the URI
followinging the given format. In case of doubt, leave empty.</dd>
<dt id="term-from-header-customization">From header customization</dt>
<dd>For those providers that show origin in other headers (PAI/RPID), it is
possible that request that From User have the account code being used
and from domain their SIP domain. In case of doubt, leave empty.</dd>
</dl>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p class="last">There are many fields to establish <em>peering</em> with multiple kind of
providers, but usually with the name and SIP Proxy will be enough (for
those that validate our platform by IP) and Authentication (for those that
won&#8217;t).</p>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">In case of defining multiple Peering Servers for a single
Peering Contract, IvozProvider will balance and failover using all of them.
Like with Application Servers, it will disable those who doesn&#8217;t respond to
our requests.</p>
</div>
</div>
<div class="section" id="sip-register">
<h4>SIP Register<a class="headerlink" href="#sip-register" title="Permalink to this headline">¶</a></h4>
<p>Some providerss require a <a class="reference external" href="https://tools.ietf.org/html/rfc3261#section-10">SIP Register</a> active in order to receive
incoming calls to our DDIs. Some of them, even require this register in order
to process our outgoing calls through their services.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">IvozProvider supports any kind of <em>peering</em>, but we highly recomend
<em>peer to peer peerings</em>: without authentication, without registry and
validated by IP. This will avoid unnecessary traffic (authentication in each
session and preriodic registers) and simplifies its configuration, just by
leaving most of the fields by default.</p>
</div>
<p>For this reason, IvozProvider allows periodic SIP register configuration in the
following section:</p>
<img alt="_images/sip_registers.png" src="_images/sip_registers.png" />
<p>If we create a new one, the following screen will be displayed:</p>
<img alt="_images/sip_registers_add.png" src="_images/sip_registers_add.png" />
<dl class="glossary docutils">
<dt id="term-username">Username</dt>
<dd>Account number or similar provider by the provider that requires SIP
register.</dd>
<dt id="term-domain">Domain</dt>
<dd>Domain or IP of the registar server. Usually the same as the SIP proxy
of the Peer server.</dd>
<dt id="term-ddi">DDI</dt>
<dd>This will be sent in the SIP Contact header and must be unique in all
the platform. For Peering contracts with an associated DDI, it is
recommended to enter that DDI. In case of multiples DDI for the same
Peering Contract, use any of them. If no DDI is associated with this
Peering Contract just enter an unique numeric value.</dd>
<dt id="term-user">User</dt>
<dd>Authentication user. Most of the time it&#8217;s the same as username, so
it&#8217;s recommended to leave empty.</dd>
<dt id="term-register-server-uri">Register server URI</dt>
<dd>Usually this can be left empty, as it can be obtained from the
Domain. If it is not the case, enter the IP address with the &#8216;sip:&#8217;
prefix.</dd>
<dt id="term-realm">Realm</dt>
<dd>Leave empty to accept the authentication realm proposed by the provider.
Define only if you are familiar to the authentication mechanism used
in SIP.</dd>
<dt id="term-expire">Expire</dt>
<dd>Default suggested register expire time.</dd>
</dl>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p class="last">Similar to the Peer Servers, there are lots of fields in the screen.
You must have into account that most of the provider doesn&#8217;t require register
, and those who does, will only use user, domain and password.</p>
</div>
</div>
</div>
<span id="document-external_incoming_calls/configure_ddi"></span><p>Once we have an agreement with a VoIP provider and we have configured it in
the <em>peering</em> section, only two task are pending:</p>
<div class="section" id="configuring-an-external-ddi">
<span id="settingup-ddi"></span><h3>Configuring an external DDI<a class="headerlink" href="#configuring-an-external-ddi" title="Permalink to this headline">¶</a></h3>
<p>The brand operator, responsible of this <em>peering</em> agreements with VoIP providers
, has the task to create the DDIs for each provider.</p>
<p>To accomplish this, following section can be used:</p>
<img alt="_images/ddis_company_section.png" class="align-center" src="_images/ddis_company_section.png" />
<p>Notice that in order to access this section, the brand operator (or <em>god</em>)
must have emulated the proper company and access the menu section <strong>Company
Configuration</strong>.</p>
<div class="admonition attention">
<p class="first admonition-title">Attention</p>
<p class="last">Section <strong>Company configuration &gt; DDIs</strong> is different when the
company administrator access than the displayed data when a global or brand
administrator does. Company administrator are unable to create or delete
DDIs, just edit the one created by the brand or god administrator.</p>
</div>
<p>The section <strong>Brand configuration &gt; DDIs</strong> is a <em>read-only</em> display of all the
DDIs of the brand, associated with the different companies.</p>
<img alt="_images/ddis_brand_section.png" class="align-center" src="_images/ddis_brand_section.png" />
<p>Taking into account this concepts, we create a new DDI and fill the required
fields:</p>
<img alt="_images/ddis_add.png" class="align-center" src="_images/ddis_add.png" />
<dl class="glossary docutils">
<dt id="term-country">Country</dt>
<dd>The country of the new created DDI. Used for E164 standarization.</dd>
<dt id="term-ddi">DDI</dt>
<dd>The number, without country code.</dd>
<dt id="term-peering-contract">Peering contract</dt>
<dd>The peering contract that provides this number. This relation allow
the platform to apply the required <a class="reference internal" href="index.html#numeric-transformations"><span class="std std-ref">Numeric transformations</span></a> in
order to determine its standard form.</dd>
<dt id="term-external-call-filter">External Call Filter</dt>
<dd>Allows configuration based on Calendars and Schedulers as shown in
<a class="reference internal" href="index.html#external-filters"><span class="std std-ref">Filtros de entrada externo</span></a>. Leave empty if you don&#8217;t need to apply any
kind of filter.</dd>
<dt id="term-route">Route</dt>
<dd>A DDI can have different <a class="reference internal" href="index.html#routing-logics"><span class="std std-ref">treatments</span></a>. For our
current goul, set route to user and select <em>Alice</em>.</dd>
<dt id="term-record-calls">Record calls</dt>
<dd>Can be used to record external calls (see <a class="reference internal" href="index.html#call-recordings"><span class="std std-ref">Grabación de llamadas</span></a>).</dd>
<dt id="term-tarificate-incoming-calls">Tarificate incoming calls</dt>
<dd>This setting requires the external tarification module and allows
tarification on special numbers. This module is not standard so don&#8217;t
hesitate in <cite>contact us &lt;getting_help&gt;</cite> if you are interested.</dd>
</dl>
</div>
<div class="section" id="configure-incoming-routes">
<h3>Configure incoming routes<a class="headerlink" href="#configure-incoming-routes" title="Permalink to this headline">¶</a></h3>
<p>In the previous section, we have created the DDI and configure it, but <strong>the
most common procedure</strong> is that the brand operator just create it while the
<strong>company administator</strong>, using the same saction <strong>will configure</strong> it choosing
the correct route (user, huntgroup, etc.), its filters with calendars and so on.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">At this point, calling the number of the configured DDI will make the
<em>Alice</em> phone ring.</p>
</div>
</div>
</div>
</div>
<span id="document-external_outgoing_calls/index"></span><div class="section" id="realizar-llamadas-externas">
<h2>Realizar llamadas externas<a class="headerlink" href="#realizar-llamadas-externas" title="Permalink to this headline">¶</a></h2>
<p>El objetivo de este bloque será configurar IvozProvider para realizar llamadas
externas salientes, partiendo de la configuración realizada hasta este momento.</p>
<p>Para ello, seguiremos los siguientes pasos:</p>
<div class="toctree-wrapper compound">
<span id="document-external_outgoing_calls/call_types"></span><div class="section" id="a-donde-llamo">
<h3>¿A dónde llamo?<a class="headerlink" href="#a-donde-llamo" title="Permalink to this headline">¶</a></h3>
<p>En este punto de la configuración, tenemos que configurar IvozProvider para que
las llamadas a los destinos externos que vayamos a probar salgan por el Contrato
de <em>peering</em> que hemos configurado en el bloque anterior.</p>
<p>Para ello, en primer lugar, necesitamos que los números externos recaigan en un
<strong>patrón de destino</strong> dado de alta con anterioridad.</p>
<div class="section" id="patrones-de-destino">
<span id="target-patterns"></span><h4>Patrones de destino<a class="headerlink" href="#patrones-de-destino" title="Permalink to this headline">¶</a></h4>
<p>Cuando un usuario marca un número externo, IvozProvider intenta calificar este
número en uno de los patrones de destino definidos en esta sección:</p>
<img alt="_images/target_patterns_section.png" class="align-center" src="_images/target_patterns_section.png" />
<p>Lo más normal será que nos interese tener un patrón de destino por cada uno de
los 254 países definidos en la <a class="reference external" href="https://es.wikipedia.org/wiki/ISO_3166">ISO 3166</a>. Por ese motivo, IvozProvider incluye
estos países y sus prefijos de forma automática:</p>
<img alt="_images/target_patterns_default.png" class="align-center" src="_images/target_patterns_default.png" />
<p>Dentro de este listado aparece el prefijo de España, que será el grupo del
número que probemos en este bloque:</p>
<img alt="_images/target_patterns_spain.png" class="align-center" src="_images/target_patterns_spain.png" />
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Cada operador de marca puede elegir mantener estos patrones o
borrarlos y crear los que le interesen. De hecho, aparte de prefijos, también
se pueden definir expresiones regulares. e.g. Queremos crear un único patrón
que englobe todas las llamadas: ^[0-9]+$.</p>
</div>
<div class="admonition danger">
<p class="first admonition-title">Danger</p>
<p class="last">Crear patrones de destino en base a expresiones regulares puede
provocar que un número encaje en 2 patrones. Usar con responsabilidad.</p>
</div>
</div>
<div class="section" id="grupos-de-patrones">
<h4>Grupos de patrones<a class="headerlink" href="#grupos-de-patrones" title="Permalink to this headline">¶</a></h4>
<p>Como veremos en la sección de <a class="reference internal" href="index.html#outgoing-routes"><span class="std std-ref">rutas salientes</span></a>, cada
patrón de destino se vinculará a un Contrato de Peering concreto.</p>
<p>Por este motivo, puede ser interesante agrupar los patrones en grupos y así
poder vincular un grupo entero a un Contrato de Peering.</p>
<p>Para ello se utiliza esta sección:</p>
<img alt="_images/target_patterngroups_section.png" class="align-center" src="_images/target_patterngroups_section.png" />
<p>Por defecto aparecen los 254 países agrupados en base a su continente definidos
en la <a class="reference external" href="https://es.wikipedia.org/wiki/ISO_3166">ISO 3166</a>:</p>
<img alt="_images/target_patterngroups_default.png" class="align-center" src="_images/target_patterngroups_default.png" />
<div class="admonition important">
<p class="first admonition-title">Important</p>
<p class="last"><strong>En resumen</strong>, cuando un usuario marca un número externo,
IvozProvider busca el patrón de destino al que pertenece para saber por dónde
tiene que sacar dicha llamada.</p>
</div>
<p>Para conseguir nuestro objetivo de llamar a un número español, no hemos tenido
que modificar el contenido de partida de estas dos secciones :)</p>
</div>
</div>
<span id="document-external_outgoing_calls/call_routing"></span><p id="outgoing-routes">Ya tenemos nuestra llamada de pruebas categorizada dentro del <strong>Patrón de
destino</strong> &#8216;España&#8217;. Es más, también tenemos un <strong>Grupo de patrones de destino</strong>
que incluye &#8216;España&#8217;, &#8216;Europa&#8217;.</p>
<p>Ahora solo nos falta decir a IvozProvider que las llamadas de &#8216;España&#8217; o de
&#8216;Europa&#8217; salgan por nuestro <strong>Contrato de peering</strong>.</p>
<div class="section" id="rutas-salientes">
<h3>Rutas salientes<a class="headerlink" href="#rutas-salientes" title="Permalink to this headline">¶</a></h3>
<p>Para realizar esta vinculación, accedemos a la sección <strong>Rutas salientes</strong>:</p>
<img alt="_images/outgoing_routes_section.png" class="align-center" src="_images/outgoing_routes_section.png" />
<p>Si optamos por enrutar solamente las llamadas de España por nuestro Contrato de
<em>peering</em>, tendremos que realizar la siguiente configuración:</p>
<img alt="_images/outgoing_routes_by_pattern.png" class="align-center" src="_images/outgoing_routes_by_pattern.png" />
<p>Por el contrario, si somos más generosos y decidimos permitir todas las llamadas
a países europeos, la configuración a aplicar sería la siguiente:</p>
<img alt="_images/outgoing_routes_by_patterngroup.png" class="align-center" src="_images/outgoing_routes_by_patterngroup.png" />
<p id="routes-metrics">Existen dos parámetros que merecen explicación:</p>
<dl class="glossary docutils">
<dt id="term-prioridad">Prioridad</dt>
<dd>Si una llamada concreta encaja con rutas de distinta prioridad, la
lamada se sacará por la que menor prioridad tenga siempre y cuando esté
disponible.</dd>
<dt id="term-metrica">Métrica</dt>
<dd>Si una llamada concreta encaja con rutas con la misma prioridad, la
métrica determina cuántas se sacarán por una ruta y cuántas por otra.</dd>
</dl>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Estos dos parámetros son clave para conseguir dos funcionalidades muy
interesantes: <strong>load-balancing</strong> y <strong>failover-routes</strong>.</p>
</div>
<div class="section" id="balanceo-de-carga">
<h4>Balanceo de carga<a class="headerlink" href="#balanceo-de-carga" title="Permalink to this headline">¶</a></h4>
<p>El balanceo de carga o <em>load-balancing</em> nos permite sacar un porcentaje de
llamadas por una ruta y otro porcentaje de llamadas por otra ruta, es decir, nos
permite repartir las llamadas entre dos o más rutas igualmente válidas.</p>
<p class="rubric">Ejemplo 1</p>
<ul class="simple">
<li>Ruta A: prioridad 1, métrica 1</li>
<li>Ruta B: prioridad 1, métrica 1</li>
</ul>
<p>Las llamadas que encajen en ambas rutas se sacaran el 50% por una ruta y el 50%
por la otra.</p>
<p class="rubric">Ejemplo 2</p>
<ul class="simple">
<li>Ruta A: prioridad 1, métrica 1</li>
<li>Ruta B: prioridad 1, métrica 2</li>
</ul>
<p>Las llamadas que encajen en ambas rutas se sacaran el 33% por la Ruta A y el 66%
por la Ruta B (el doble por B que por A).</p>
</div>
<div class="section" id="conmutacion-por-error">
<h4>Conmutación por error<a class="headerlink" href="#conmutacion-por-error" title="Permalink to this headline">¶</a></h4>
<p>Las rutas en caso de fallo o <em>failover-routes</em> nos permite disponer de ruta
adicional en caso de que la ruta preferida falle.</p>
<p class="rubric">Ejemplo</p>
<ul class="simple">
<li>Ruta A: prioridad 1, métrica 1</li>
<li>Ruta B: prioridad 2, métrica 1</li>
</ul>
<p>Las llamadas que encajen en ambas rutas se intentarán sacar siempre por la Ruta
A. En caso de no error (operador caído, etc.), se intentará sacar por la Ruta B.</p>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p class="last">Tanto el balanceo de carga como las rutas de fallo permiten
encadenar/utilizar más de 2 rutas, aunque en los ejemplo se hayan utilizado
solo 2.</p>
</div>
</div>
</div>
<span id="document-external_outgoing_calls/external_ddi"></span><div class="section" id="configurar-ddi-saliente">
<span id="external-ddi"></span><h3>Configurar DDI saliente<a class="headerlink" href="#configurar-ddi-saliente" title="Permalink to this headline">¶</a></h3>
<p>Antes de realizar la llamada externa, estaría muy bien que dicha llamada se
presentara con el DDI que ya hemos configurado en entrada, así el llamado podría
devolvernos la llamada cómodamente.</p>
<p>Para ello, basta con configurar dicho DDI como <strong>DDI saliente</strong> de <em>Alice</em>, que
será la elegida para realizar la primera llamada saliente de nuestro recién
instalado IvozProvider:</p>
<img alt="_images/ddi_out.png" src="_images/ddi_out.png" />
<p>Esta configuración se realiza desde <strong>Configuración de empresa</strong> &gt; <strong>Usuarios</strong>,
editando el usuario de <em>Alice</em>. Si ese el operador de marca o el operador global
el que realiza esta edición, tendrá que haber <a class="reference internal" href="index.html#emulate-company"><span class="std std-ref">emulado la empresa</span></a> previamente.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Sin configurar un DDI saliente para el usuario que realiza la
llamada, ésta no saldrá al exterior.</p>
</div>
</div>
<span id="document-external_outgoing_calls/noplan_nocall"></span><p>Llegados a este punto y estando deseosos como estamos de hacer nuestra primera
llamada, habremos intentando llamar con la configuración actual pero...</p>
<div class="section" id="sin-plan-de-precio-no-hay-llamada">
<span id="noplan-nocall"></span><h3>Sin plan de precio, no hay llamada<a class="headerlink" href="#sin-plan-de-precio-no-hay-llamada" title="Permalink to this headline">¶</a></h3>
<p>Tal y como advertimos <a class="reference internal" href="index.html#brand-responsibilities"><span class="std std-ref">cuando describimos las funciones del operador de
marca</span></a>, el operador de marca era el <strong>responsable de
realizar la configuración necesaria para que todas las llamadas externas se
puedan tarificar</strong>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Se entiende por <strong>tarificar</strong> la <strong>acción de poner precio</strong> a una
llamada que implique coste.</p>
</div>
<p>Para evitar que por un descuido el operador de marca no defina el precio para
un tipo de llamada y llamadas que implican coste salgan a precio 0, <strong>en el
momento del establecimiento de una llamada se comprueba que la llamada se va a
poder tarificar</strong>.</p>
<div class="admonition error">
<p class="first admonition-title">Error</p>
<p class="last">Si una llamada no se va a poder tarificar, IvozProvider no permitirá
su establecimiento.</p>
</div>
<div class="section" id="crear-un-patron-de-precio">
<span id="price-pattern"></span><h4>Crear un patrón de precio<a class="headerlink" href="#crear-un-patron-de-precio" title="Permalink to this headline">¶</a></h4>
<p>Del mismo modo que existen los <a class="reference internal" href="index.html#target-patterns"><span class="std std-ref">patrones de destino</span></a>,
existen los <strong>patrones de precio</strong> y se configuran en esta sección:</p>
<img alt="_images/pricing_pattern_section.png" src="_images/pricing_pattern_section.png" />
<div class="admonition important">
<p class="first admonition-title">Important</p>
<p class="last">Para que una llamada se considere tarificable, tiene que
<em>matchear</em> con algún patrón de precio dado de alta previamente.</p>
</div>
<p>A diferencia de los patrones de destino, que vienen precreados con los 254
países del mundo, los patrones de precio no se crean ya que lo habitual es que
un país se divida en muchos patrones de precio (redes GSM de un operador,
numeraciones especiales, números fijos, números móviles, etc.).</p>
<p>Creemos el patrón de precio <em>Spain</em> para nuestra llamada saliente externa:</p>
<img alt="_images/pricing_pattern_add.png" src="_images/pricing_pattern_add.png" />
</div>
<div class="section" id="crear-un-plan-de-precio">
<span id="price-plan"></span><h4>Crear un plan de precio<a class="headerlink" href="#crear-un-plan-de-precio" title="Permalink to this headline">¶</a></h4>
<p>Un <strong>Plan de precio</strong> determina el coste de un tipo de llamada (de un patrón de
precio) y se configura en esta sección:</p>
<img alt="_images/pricing_plans_section.png" src="_images/pricing_plans_section.png" />
<p>Creamos un <strong>plan de precio</strong> para nuestro objetivo:</p>
<img alt="_images/pricing_plans_add1.png" src="_images/pricing_plans_add1.png" />
<p>Y le añadimos el <strong>patrón de precio</strong> que hemos creado antes:</p>
<img alt="_images/pricing_plans_add_price1.png" src="_images/pricing_plans_add_price1.png" />
<img alt="_images/pricing_plans_add_price2.png" src="_images/pricing_plans_add_price2.png" />
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Los números decimales se tienen que introducir utilizando el &#8221;.&#8221; como
separador decimal (e.g. 0.02)</p>
</div>
<p class="rubric">Encontrar un plan de precios para un destino concreto</p>
<p>Para comprobar que hasta este punto la configuración es correcta, podemos
<strong>encontrar un plan de precio</strong> para una llamada concreta pulsando:</p>
<img alt="_images/pricing_plans_find_plan.png" src="_images/pricing_plans_find_plan.png" />
<p>Introducimos el número destino en <a class="reference internal" href="index.html#e164"><span class="std std-ref">formato E.164</span></a>:</p>
<img alt="_images/pricing_plans_find_plan2.png" src="_images/pricing_plans_find_plan2.png" />
<p>Y vemos que <em>matchea</em> con el <strong>plan de precio</strong> que acabamos de crear:</p>
<img alt="_images/pricing_plans_find_plan3.png" src="_images/pricing_plans_find_plan3.png" />
</div>
<div class="section" id="vincular-plan-de-precio-a-empresa">
<span id="pricing-plan-to-company"></span><h4>Vincular plan de precio a empresa<a class="headerlink" href="#vincular-plan-de-precio-a-empresa" title="Permalink to this headline">¶</a></h4>
<p>Un <strong>plan de precios</strong> concreto se puede vincular a <em>n</em> empresas y corresponde
al <em>Operador de marca</em> realizar esta vinculación.</p>
<p>Para ello, desde la sección <strong>Configuración de Marca</strong> &gt; <strong>Empresas</strong>,
seleccionando la empresa <em>demo</em>:</p>
<img alt="_images/pricing_plans_relate_company.png" src="_images/pricing_plans_relate_company.png" />
<p>La vinculación de <strong>Planes de precio</strong> y <strong>Empresas</strong> es efectiva en un período
de tiempo concreto, de ahí que haya que seleccionar <em>Fecha inicio</em> y <em>Fecha fin</em>:</p>
<img alt="_images/pricing_plans_relate_company2.png" src="_images/pricing_plans_relate_company2.png" />
<p>La <strong>metrica</strong> de la vinculación permite vincular más de un <em>plan de precios</em> a
una empresa de forma coincidente en el tiempo, aunque ciertos destinos estén
incluidos en más de uno de esos planes de precio.</p>
<div class="admonition attention">
<p class="first admonition-title">Attention</p>
<p class="last">Una llamada que puede tarificarse en base a más de un plan de
precio vinculado a una empresa y activo en un momento dado lo hará en base al
plan de precio con menor métrica.</p>
</div>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p class="last">Esto permite tener un <em>Plan de precios</em> general y matizar el coste de
algún tipo de llamada en otro <em>Plan de precio</em> (móviles gratis, por ejemplo).</p>
</div>
<p class="rubric">Simular una llamada desde una empresa concreta</p>
<p>Del mismo modo que al crear un <em>Plan de precios</em> hemos comprobado que a nuestra
llamada aplicaba dicho plan, podemos simular una llamada concreta en una empresa
concreta y saber qué coste se le aplicaría:</p>
<img alt="_images/pricing_plans_simulate_companycall.png" src="_images/pricing_plans_simulate_companycall.png" />
<p>Introducimos el número destino en <a class="reference internal" href="index.html#e164"><span class="std std-ref">formato E.164</span></a>:</p>
<img alt="_images/pricing_plans_simulate_companycall2.png" class="align-center" src="_images/pricing_plans_simulate_companycall2.png" />
<p>Y vemos que efectivamente se le asignaría un precio correcto en base al plan de
precio que acabamos de crear y vincular:</p>
<img alt="_images/pricing_plans_simulate_companycall3.png" src="_images/pricing_plans_simulate_companycall3.png" />
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">En este punto, <em>Alice</em> debería de ser capaz de realizar llamadas
nacionales externas, que se tendrían que cursar y tarificar con normalidad.</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="toctree-wrapper compound" id="advanced">
<span id="document-pbx_features/index"></span><div class="section" id="funcionalidades-de-pbx">
<h2>Funcionalidades de PBX<a class="headerlink" href="#funcionalidades-de-pbx" title="Permalink to this headline">¶</a></h2>
<p>En el bloque anterior hemos conseguido realizar llamadas internas y externas
realizando una configuración mínima, partiendo de la configuración que deja el
propio instalador y dejando de lado múltiples apartados y funcionalidades.</p>
<p>El objetivo de este bloque será describir cada una de estas secciones con
profundidad y ver así las funcionalidades de PBX que IvozProvider ofrece.</p>
<p>Para ello, seguiremos el siguiente índice:</p>
<div class="toctree-wrapper compound">
<span id="document-pbx_features/extensions"></span><div class="section" id="extensions">
<h3>Extensions<a class="headerlink" href="#extensions" title="Permalink to this headline">¶</a></h3>
<p>La configuración de partida incluía 2 extensiones (101 y 102) que apuntaban
directamente a <em>Alice</em> y <em>Bob</em>, por lo que apenas dijimos nada sobre la
sección <strong>Configuración de empresa</strong> &gt; <strong>Extensiones</strong>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last"><strong>Una extensión es</strong>, por definición, <strong>un número interno con una
lógica asignada</strong>.</p>
</div>
<p class="rubric">Crear una nueva extensión</p>
<p>La ventana de creación de una nueva extensión es tal que así:</p>
<img alt="_images/extension_add.png" src="_images/extension_add.png" />
<dl class="glossary docutils">
<dt id="term-numero">Número</dt>
<dd>El número que al ser marcado por un usuario interno activará la
lógica que sigue. Tiene que tener una longitud mínima de 2 y estar
compuesto únicamente por dígitos.</dd>
<dt id="term-enrutar">Enrutar</dt>
<dd>Este selector nos permite indicar la lógica que seguirá esta numeración
cuando sea marcada por un usuario concreto. Al seleccionar un ítem en
cuestión, se nos mostrará un selector adicional para seleccionar el
grupo de salto, sala de conferencias, etc.</dd>
</dl>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">En el caso de las extensiones que apuntan a usuario, la vinculación
con el usuario concreto tendrá que hacerse desde <strong>Configuración de
empresa</strong> &gt; <strong>Usuarios</strong>.</p>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Si existe una extensión cuyo número conflicte con un número
externo, el número externo quedará enmascarado y resultará, en la práctica,
inaccesible para toda la empresa.</p>
</div>
</div>
<span id="document-pbx_features/terminals"></span><div class="section" id="terminales">
<span id="terminals"></span><h3>Terminales<a class="headerlink" href="#terminales" title="Permalink to this headline">¶</a></h3>
<p>La sección <strong>Configuración de empresa</strong> &gt; <strong>Terminales</strong> permite dar de alta
credenciales SIP que podrán ser utilizados por diversos dispositivos SIP para
realizar y recibir llamadas de IvozProvider.</p>
<p>La mejor forma de entender la sección es crear uno nuevo y ver los campos que
tenemos que cumplimentar:</p>
<img alt="_images/terminals_add.png" src="_images/terminals_add.png" />
<dl class="glossary docutils">
<dt id="term-nombre">Nombre</dt>
<dd>Usuario que utilizará el terminal para presentarse ante IvozProvider y
para realizar la fase de autenticación SIP.</dd>
<dt id="term-contrasena">Contraseña</dt>
<dd>Contraseña que utilizará el terminal para responder a la fase de
autenticación SIP. Utilizar el generador automático de contraseñas para
cumplir los criterios de seguridad exigidos.</dd>
<dt id="term-codecs-rechazados-permitidos">Codecs rechazados/permitidos</dt>
<dd>Indica las capacidades del terminal en lo que a codecs se refiere.
Primero se descarta los rechazados y posteriormente incluye los
soportados. Se recomienda dejar <em>alaw</em> como único soportado.</dd>
<dt id="term-modo-de-actualizacion">Modo de actualización</dt>
<dd>Indica si el terminal prefiere utilizar reINVITEs o UPDATEs para
actualizar la sesión. La sección de ayuda indica qué terminales suelen
requerir qué método. En caso de duda, utilizar <em>invite</em>.</dd>
<dt id="term-modelo-de-terminal">Modelo de terminal</dt>
<dd>Indica el tipo de provisión que tendrá que recibir este terminal
concreto. En el apartado dedicado a la <a class="reference internal" href="index.html#provisioning"><span class="std std-ref">provisión de terminales</span></a> se verá que existen unos modelos con provisión
automática y se explicará todo en profundidad. En caso de no necesitar
provisión, utilizar <em>Generic</em>.</dd>
<dt id="term-mac">MAC</dt>
<dd>Campo necesario para modelos que utilizan el sistema de <a class="reference internal" href="index.html#provisioning"><span class="std std-ref">provisión
de terminales</span></a> de IvozProvider. Recoge la <a class="reference external" href="https://es.wikipedia.org/wiki/Direcci%C3%B3n_MAC">dirección
física</a> del
adaptador de red del dispositivo SIP.</dd>
</dl>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last"><strong>En la mayoría</strong> de dispositivos, siempre que no requieran
provisión, <strong>bastará con rellenar el nombre y contraseña</strong>.</p>
</div>
<div class="admonition hint">
<p class="first admonition-title">Hint</p>
<p class="last">Una vez dado de alta el Terminal, en la mayoría de dispositivos
bastará con configurar nombre, contraseña y <a class="reference internal" href="index.html#domain-per-company"><span class="std std-ref">dominio SIP de la
compañía</span></a> para poder llamar.</p>
</div>
</div>
<span id="document-pbx_features/call_permissions"></span><div class="section" id="control-acl-para-llamadas">
<span id="call-permissions"></span><h3>Control ACL para llamadas<a class="headerlink" href="#control-acl-para-llamadas" title="Permalink to this headline">¶</a></h3>
<p>Los <strong>Permisos de llamada</strong> determinan qué usuarios pueden llamar a qué
destinos internos.</p>
<div class="admonition attention">
<p class="first admonition-title">Attention</p>
<p class="last">Las extensiones internas son accesibles por todos los usuarios,
<strong>los permisos de llamada solo aplican a llamadas externas</strong>.</p>
</div>
<p>La configuración de <strong>permisos de llamada</strong> tiene 2 partes:</p>
<ul>
<li><p class="first">Clasificar las llamadas en determinados tipos utilizando <strong>expresiones
regulares</strong> <a class="footnote-reference" href="#id2" id="id1">[*]</a>:</p>
<blockquote>
<div><ul class="simple">
<li>A nivel de marca: <strong>Configuración de Marca</strong> &gt; <strong>Patrones de permiso
genéricos</strong>.</li>
<li>A nivel de empresa: <strong>Configuración de Empresa</strong> &gt; <strong>Patrones de permisos
de llamada</strong>.</li>
</ul>
</div></blockquote>
</li>
<li><p class="first">Definir políticas para los patrones deseados: <strong>Configuración de Empresa</strong> &gt;
<strong>Permisos llamada</strong></p>
</li>
</ul>
<div class="section" id="patrones-de-permiso">
<h4>Patrones de permiso<a class="headerlink" href="#patrones-de-permiso" title="Permalink to this headline">¶</a></h4>
<p>La clasificación de llamadas se realiza en las secciones indicadas a nivel de
marca o a nivel de empresa.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Cuando un operador de marca crea una empresa, todos los <strong>Patrones de
permiso genéricos</strong> definidos en ese momento a nivel de <strong>Configuración de
Marca</strong> se copian a <strong>Configuración de Empresa</strong> &gt; <strong>Patrones de permisos de
llamada</strong>. De esta forma, el operador de marca puede definir los más
habituales y evitar este trabajo a los administradores de empresa.</p>
</div>
<p>La creación de nuevos patrones es muy simple:</p>
<img alt="_images/permissions_patterns.png" src="_images/permissions_patterns.png" />
<p>Este nuevo patrón de permisos engloba las llamadas que comiencen por 6 o 7 y
sigan con 8 dígitos del 0 al 9. Es decir, engloba todas las numeraciones
móviles nacionales.</p>
<p>Otros patrones de permisos que pueden resultar interesantes son:</p>
<ul class="simple">
<li><dl class="first docutils">
<dt>Fijos nacionales (incluyendo numeraciones especiales: 902, etc.): ^[89][0-9]{8}$</dt>
<dd><ul class="first last">
<li>Un 8 o un 9 seguido de 8 dígitos.</li>
</ul>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>Fijos nacionales (excluyendo numeraciones especiales: 902, etc.): ^[89][1-9][0-9]{7}$</dt>
<dd><ul class="first last">
<li>Un 8 o un 9, seguido de 1 dígito del 1 al 9, seguido de 7 dígitos.</li>
</ul>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>Llamadas internacionales: ^00[0-9]+$</dt>
<dd><ul class="first last">
<li>00 (código internacional) seguido de 1 o más dígitos.</li>
</ul>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>Llamadas a Reino Unido: ^0044[0-9]+$</dt>
<dd><ul class="first last">
<li>00 (código internacional), 44 (código de UK), seguido de 1 o más dígitos.</li>
</ul>
</dd>
</dl>
</li>
</ul>
<p class="rubric">Formato de los números externos</p>
<p>Las expresiones regulares de los patrones de permiso tienen que utilizar el
formato que utilice un usuario del mismo país que la compañía a la hora de
llamar.</p>
<p>Es decir, un usuario (español, porque tal y como veremos los usuarios tienen
también un código de país) de una empresa de española llamará a números
móviles, por ejemplo, así: 676 676 676.</p>
<div class="admonition danger">
<p class="first admonition-title">Danger</p>
<p class="last">No se utiliza código de país ni formato E.164, <strong>se escriben las
expresiones regulares tal y como llamaría un usuario con el mismo código de
país que la empresa en cuestión</strong>.</p>
</div>
</div>
<div class="section" id="permisos-de-llamada">
<h4>Permisos de llamada<a class="headerlink" href="#permisos-de-llamada" title="Permalink to this headline">¶</a></h4>
<p>La definición de un <strong>Permiso de llamada</strong> utiliza una lógica más fácil de
describir con un ejemplo.</p>
<p>Imaginemos que tenemos los siguientes <strong>patrones de permisos</strong>:</p>
<img alt="_images/permissions_patterns_list.png" src="_images/permissions_patterns_list.png" />
<p>Podríamos definir un <strong>Permiso de llamada</strong> como el que sigue:</p>
<img alt="_images/permissions_add.png" src="_images/permissions_add.png" />
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">La acción por defecto describe lo que hay que hacer con la llamada
una vez que se han evaluado todas las reglas (permitir/rechazar).</p>
</div>
<p>Editamos el <strong>permiso de llamada</strong> que acabamos de crear para añadir las reglas
necesarias:</p>
<img alt="_images/permissions_add2.png" src="_images/permissions_add2.png" />
<p>La <strong>métrica</strong> determina el orden de evaluación de las reglas y la acción lo
que se hará con la llamada en caso de <em>matchear</em> (permitir/rechazar).</p>
<img alt="_images/permissions_add3.png" src="_images/permissions_add3.png" />
<p>Una vez hecho lo propio para el otro <strong>patrón de permisos</strong>, nuestro <strong>permiso
de llamadas</strong> quedará como sigue:</p>
<img alt="_images/permissions_add4.png" src="_images/permissions_add4.png" />
<p>Ya solo faltaría añadírselo a un usuario concreto en la sección <strong>Configuración
de empresa</strong> &gt; <strong>Usuarios</strong>:</p>
<img alt="_images/permissions_add5.png" src="_images/permissions_add5.png" />
<p>Desde este momento, Alice solo podría llamar a extensiones internas (siempre
están permitidas) y a móviles y fijos nacionales.</p>
<table class="docutils footnote" frame="void" id="id2" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id1">[*]</a></td><td><a class="reference external" href="https://es.wikipedia.org/wiki/Expresi%C3%B3n_regular">https://es.wikipedia.org/wiki/Expresi%C3%B3n_regular</a></td></tr>
</tbody>
</table>
</div>
</div>
<span id="document-pbx_features/users"></span><div class="section" id="usuarios">
<span id="users"></span><h3>Usuarios<a class="headerlink" href="#usuarios" title="Permalink to this headline">¶</a></h3>
<p>El proceso de instalación nos creó a <em>Alice</em> y a <em>Bob</em>, y esto nos permitió
ahorrar mucho tiempo a la hora de conseguir que se llamarán entre ellos.</p>
<p>También nos permitió pasar un poco de puntillas por la sección de <strong>Usuarios</strong>,
que ahora pasamos a definir en profundidad.</p>
<p>Para ello, nada mejor que editar el usuario <em>Alice</em> y describir cada campo del
mismo, bloque a bloque:</p>
<div class="section" id="datos-personales">
<h4>Datos personales<a class="headerlink" href="#datos-personales" title="Permalink to this headline">¶</a></h4>
<img alt="_images/users_edit_personal_data.png" src="_images/users_edit_personal_data.png" />
<dl class="glossary docutils">
<dt id="term-nombre">Nombre</dt>
<dd>Se utilizará para referenciar al usuario en múltiples ámbitos,
incluyendo el nombre que se presenta en llamadas internas.</dd>
<dt id="term-apellidos">Apellidos</dt>
<dd>Irá junto con el Nombre en casi todos los casos.</dd>
<dt id="term-email">Email</dt>
<dd>Dirección de correo electrónico del usuario al que se enviarán los
mensajes de voz del buzón.</dd>
</dl>
</div>
<div class="section" id="credenciales-portal-de-usuario">
<h4>Credenciales portal de usuario<a class="headerlink" href="#credenciales-portal-de-usuario" title="Permalink to this headline">¶</a></h4>
<img alt="_images/users_edit_login.png" src="_images/users_edit_login.png" />
<dl class="glossary docutils">
<dt id="term-nombre-de-usuario">Nombre de usuario</dt>
<dd>Nombre de usuario para acceder al <a class="reference internal" href="index.html#userportal"><span class="std std-ref">portal de usuario</span></a>.</dd>
<dt id="term-contrasena">Contraseña</dt>
<dd>Contraseña para acceder al <a class="reference internal" href="index.html#userportal"><span class="std std-ref">portal de usuario</span></a>.</dd>
<dt id="term-activo">Activo</dt>
<dd>Da posibilidad al administrador de la plataforma de desactivar el
acceso al <a class="reference internal" href="index.html#userportal"><span class="std std-ref">portal de usuario</span></a>.</dd>
</dl>
</div>
<div class="section" id="configuracion-basica">
<h4>Configuración básica<a class="headerlink" href="#configuracion-basica" title="Permalink to this headline">¶</a></h4>
<img alt="_images/users_edit_basic_config.png" src="_images/users_edit_basic_config.png" />
<dl class="glossary docutils">
<dt id="term-terminal">Terminal</dt>
<dd>Los terminales dados de alta en <a class="reference internal" href="index.html#terminals"><span class="std std-ref">Terminales</span></a> se listan aquí para
realizar la vinculación usuario-terminal.</dd>
<dt id="term-extension">Extensión</dt>
<dd>Tal y como se explicaba en <a class="reference internal" href="index.html#extensions"><span class="std std-ref">Extensions</span></a>, fija la extensión del
usuario para llamadas internas.</dd>
<dt id="term-ddi-de-salida">DDI de salida</dt>
<dd>Adelantado en <a class="reference internal" href="index.html#external-ddi"><span class="std std-ref">Configurar DDI saliente</span></a>, determina el número que presenta el
usuario en llamadas externas salientes.</dd>
<dt id="term-permiso-de-llamada">Permiso de llamada</dt>
<dd>Asignación de un grupo de permisos explicado en profundidad
<a class="reference internal" href="index.html#call-permissions"><span class="std std-ref">aquí</span></a>.</dd>
<dt id="term-no-molestar">No molestar</dt>
<dd>Impide que nadie pueda llamar a este usuario, sin impedirle a él
llamar a donde desee.</dd>
<dt id="term-llamada-en-espera">Llamada en espera</dt>
<dd>Determina si el sistema tendrá que llamar al usuario cuando éste ya
esté en conversación.</dd>
</dl>
</div>
<div class="section" id="buzon-de-voz">
<h4>Buzón de voz<a class="headerlink" href="#buzon-de-voz" title="Permalink to this headline">¶</a></h4>
<img alt="_images/users_edit_vm.png" src="_images/users_edit_vm.png" />
<dl class="glossary docutils">
<dt id="term-buzon-de-voz">Buzón de voz</dt>
<dd>Activa o desactiva <strong>la existencia</strong> del buzón de voz del usuario.
Aparte de existir, como veremos <a class="reference internal" href="#fwd-to-vm"><span class="std std-ref">más adelante</span></a>, habrá
que desviar las llamadas que queramos al buzón.</dd>
<dt id="term-notificar-por-email">Notificar por email</dt>
<dd>Mandar a la dirección del usuario un correo notificando del mensaje de
voz.</dd>
<dt id="term-adjuntar-audio-del-mensaje">Adjuntar audio del mensaje</dt>
<dd>Adjuntar o no en dicho mail el audio del mensaje</dd>
</dl>
</div>
<div class="section" id="jefe-asistente">
<h4>Jefe-Asistente<a class="headerlink" href="#jefe-asistente" title="Permalink to this headline">¶</a></h4>
<img alt="_images/users_edit_boss.png" src="_images/users_edit_boss.png" />
<p>La funcionalidad jefe-asistente impide que un usuario sea molestado por nadie
que no sea:</p>
<ul class="simple">
<li>Su asistente.</li>
<li>Las excepciones que él defina.</li>
</ul>
<p>Toda llamada con destino a <em>un jefe</em> será desviada al asistente.</p>
<dl class="glossary docutils">
<dt id="term-jefe">Jefe</dt>
<dd>Indica que el usuario en cuestión es jefe o no.</dd>
<dt id="term-asistente">Asistente</dt>
<dd>Si el usuario es jefe, indica quién es su asistente.</dd>
<dt id="term-whitelist-jefe-asistente">Whitelist jefe/asistente</dt>
<dd>Permite indicar utilizando expresiones regulares las excepciones
deseadas.</dd>
</dl>
<p>Con la configuración de la imagen, toda llamada a <em>Alice</em> acabará en <em>Bob</em>,
salvo las que haga el propio <em>Bob</em> y el número de teléfono 945 945 945.</p>
</div>
<div class="section" id="pertenencia-a-grupos">
<h4>Pertenencia a grupos<a class="headerlink" href="#pertenencia-a-grupos" title="Permalink to this headline">¶</a></h4>
<img alt="_images/users_edit_groups.png" src="_images/users_edit_groups.png" />
<p>Tal y como se verá en las secciones <a class="reference internal" href="index.html#huntgroups"><span class="std std-ref">Grupos de salto</span></a> y <a class="reference internal" href="index.html#capture-groups"><span class="std std-ref">Capturas de llamada</span></a>,
un usuario puede pertenecer a uno o a varios grupos de captura y grupos de salto.</p>
<p>Aparte de poder configurar dicha pertenencia desde las propias secciones
<a class="reference internal" href="index.html#huntgroups"><span class="std std-ref">Grupos de salto</span></a> y <a class="reference internal" href="index.html#capture-groups"><span class="std std-ref">Capturas de llamada</span></a>, se puede añadir al usuario que
estamos editando a los grupos de captura y grupos de salto deseados que ya
existan.</p>
<p>En el caso de la pertenencia a <strong>grupos de salto</strong>, también se puede configurar
desde el listado general:</p>
<img alt="_images/users_huntgroups.png" class="align-center" src="_images/users_huntgroups.png" />
</div>
<div class="section" id="desvios-de-llamada">
<h4>Desvíos de llamada<a class="headerlink" href="#desvios-de-llamada" title="Permalink to this headline">¶</a></h4>
<p>Los desvíos de las llamadas de un usuario concreto se configura pulsando el
siguiente botón:</p>
<img alt="_images/users_call_fwd.png" class="align-center" src="_images/users_call_fwd.png" />
<p id="fwd-to-vm">Para desviar las llamadas externas que no se contesten en 15 segundos al buzón
de voz que acabamos de configurar, por ejemplo, habría que configurar un desvío
tal que:</p>
<img alt="_images/users_call_fwd2.png" class="align-center" src="_images/users_call_fwd2.png" />
<p>Estos son los campos y los posibles valores:</p>
<dl class="glossary docutils">
<dt id="term-tipo-de-llamada">Tipo de llamada</dt>
<dd>Limita el desvío a cierto tipo de llamadas, a elegir entre externa,
interna o ambas</dd>
<dt id="term-tipo-de-desvio">Tipo de desvío</dt>
<dd><dl class="first last docutils">
<dt>Indica cuándo aplica el desvío:</dt>
<dd><ul class="first last simple">
<li>Incondicional: siempre</li>
<li>Perdida: cuando no se conteste al de X segundos</li>
<li>Ocupado: cuando el usuario esté ocupado (hablando o con el <em>No
molestar</em> activo)</li>
<li>No registrado: cuando el usuario tenga su terminal sin conectar
con IvozProvider</li>
</ul>
</dd>
</dl>
</dd>
<dt id="term-tipo-de-destino">Tipo de destino</dt>
<dd><dl class="first last docutils">
<dt>Indica a dónde se enviará la llamada cuando el desvío aplique:</dt>
<dd><ul class="first last simple">
<li>Buzón de voz</li>
<li>Número (externo)</li>
<li>Extensión (interna)</li>
</ul>
</dd>
</dl>
</dd>
</dl>
<div class="admonition hint">
<p class="first admonition-title">Hint</p>
<p class="last">Si queremos que desviar a un grupo de salto, por ejemplo, bastaría
con crear una extensión que apunte al grupo de salto deseado y seleccionar
<em>Extensión</em> en el <strong>Tipo de destino</strong>.</p>
</div>
</div>
</div>
<span id="document-pbx_features/music_on_hold"></span><div class="section" id="musica-en-espera">
<span id="musiconhold"></span><h3>Música en espera<a class="headerlink" href="#musica-en-espera" title="Permalink to this headline">¶</a></h3>
<p>La música en espera suena cuando un usuario retiene la llamada y su
interlocutor queda a la espera de seguir la conversación.</p>
<p>IvozProvider permite definir la música que sonará en estos momentos en 2
niveles distintos:</p>
<ul class="simple">
<li>A nivel de operador de marca: <strong>Configuración de Marca</strong> &gt; <strong>Músicas en
espera genéricas</strong></li>
<li>A nivel de administrador de empresa: <strong>Configuración de Empresa</strong> &gt; <strong>Música
en espera</strong></li>
</ul>
<p>Si una empresa define su música en espera, sonará. Si, por el contrario, no
define ninguna, sonará la que haya definido el operador de su marca.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Se pueden definir más de una música en espera y el sistema elegirá
de forma aleatoria la música en espera para cada llamada.</p>
</div>
<p class="rubric">Añadir una nueva música en espera</p>
<img alt="_images/moh_add.png" src="_images/moh_add.png" />
<p>Una vez <em>encodeada</em> el campo <strong>Status</strong> muestra que está <em>ready</em> y se utilizará
en las próximas llamadas:</p>
<img alt="_images/moh_add2.png" src="_images/moh_add2.png" />
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p class="last">IvozProvider reconoce archivos de audio en los formatos más comunes y
los <em>encodea</em> a los formatos óptimos para la plataforma.</p>
</div>
<p>Después de <em>encodear</em>, podemos descargar el archivo original y el convertido
sin más que editar el ítem:</p>
<img alt="_images/moh_add3.png" src="_images/moh_add3.png" />
</div>
</div>
<div class="toctree-wrapper compound">
<span id="document-pbx_features/sounds"></span><div class="section" id="locuciones">
<h3>Locuciones<a class="headerlink" href="#locuciones" title="Permalink to this headline">¶</a></h3>
<p>Las locuciones de la plataforma se crean y se suben de forma idéntica a cómo
lo hacen las <a class="reference internal" href="index.html#musiconhold"><span class="std std-ref">músicas en espera</span></a>.</p>
<p>La sección que permite al administrador de empresa subir las locuciones que
utilizará en diversos puntos de la configuración (IVR, etc.) es <strong>Configuración
de Empresa</strong> &gt; <strong>Locuciones</strong>.</p>
<img alt="_images/sounds.png" src="_images/sounds.png" />
<div class="admonition hint">
<p class="first admonition-title">Hint</p>
<p class="last">La única diferencia entre una <strong>locución</strong> y una <strong>música en espera</strong>
es su uso: la primera sonará cuando el administrador de empresa lo indique
(fuera de horario, IVRs, etc.) y la segunda, en cambio, cuando la llamada
sea retenida por un usuario.</p>
</div>
</div>
<span id="document-pbx_features/external_filters"></span><div class="section" id="filtros-de-entrada-externo">
<span id="external-filters"></span><h3>Filtros de entrada externo<a class="headerlink" href="#filtros-de-entrada-externo" title="Permalink to this headline">¶</a></h3>
<p>Una de las configuraciones más habituales que todo administrador de empresa
querrá realizar en un momento dado es poner filtros de horario y de calendario
a sus <a class="reference internal" href="index.html#external-ddis"><span class="std std-ref">DDIs externos</span></a>.</p>
<p>Para ello, el primer paso es crear un horario.</p>
<p class="rubric">Crear un horario</p>
<p>La sección <strong>Configuración de Empresa</strong> &gt; <strong>Horarios</strong> permite definir los
tramos horarios en los que un <a class="reference internal" href="index.html#external-ddis"><span class="std std-ref">DDI externo</span></a> está dentro
de horario.</p>
<p>La interfaz que se le presenta al administrador de empresa cuando añade un
horario es la siguiente:</p>
<img alt="_images/timetables_add.png" src="_images/timetables_add.png" />
<p>Con la configuración anterior, hemos definido el tramo horario de mañana de una
empresa de Lunes a Jueves.</p>
<p>Sigamos con el ejemplo y definamos el tramo horario de tarde de Lunes a Jueves:</p>
<img alt="_images/timetables_add2.png" src="_images/timetables_add2.png" />
<p>Y el horario reducido de los viernes:</p>
<img alt="_images/timetables_add3.png" src="_images/timetables_add3.png" />
<p>Ya tenemos los siguientes tramos horarios que, combinados, describen un horario
de oficina tradicional:</p>
<img alt="_images/timetables_add4.png" src="_images/timetables_add4.png" />
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Los horarios definen, una vez sumados, los tramos horarios activos:
toda hora que no caiga dentro de uno de los tramos agrupados será
considerada como llamada fuera de horario.</p>
</div>
<p class="rubric">Crear un calendario</p>
<p>Los calendarios definen, una vez sumados, los días que se tienen que considerar
festivos.</p>
<p>Imaginemos que creamos 3 calendarios tal que:</p>
<img alt="_images/calendars_list.png" src="_images/calendars_list.png" />
<p>La creación de calendarios solo requiere dar un nombre al mismo, una vez creado
hay que añadir días festivos a dicho calendario pulsando el botón de la derecha
del lápiz:</p>
<img alt="_images/calendars_add_day.png" src="_images/calendars_add_day.png" />
<p>Desde este momento, es calendario tiene marcado el día 1 de Enero de 2016 como
día festivo con locución de festivo especial llamada &#8220;Feliz año&#8221;.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Los calendarios tienen una lógica contraria a los horarios: si un
día concreto no está definido como festivo en uno de los calendarios, será
considerado como día laborable.</p>
</div>
<div class="admonition hint">
<p class="first admonition-title">Hint</p>
<p class="last">Si un día es festivo en un calendario y no hay locución de festivo
especial, se reproducirá la locución de festivo del filtro de entrada
externo (ver más abajo).</p>
</div>
<p class="rubric">Crear un filtro de entrada externo</p>
<p>Una vez que tenemos unos horaris y unos calendarios creados, llega el momento
de agruparlos en lo que en IvozProvider se conoce por <strong>Filtro de entrada
externos</strong>.</p>
<p>El interfaz que se le presenta al administrador de empresa es el siguiente:</p>
<img alt="_images/external_call_filter.png" src="_images/external_call_filter.png" />
<dl class="glossary docutils">
<dt id="term-nombre">Nombre</dt>
<dd>Nombre con el que se referenciará este filtro.</dd>
<dt id="term-locucion-de-bienvenida">Locución de bienvenida</dt>
<dd>Esta locución se reproduce siempre que la llamada no se va a rechazar
por festivo o fuera horario (es decir, en una hora normal de un día
normal).</dd>
<dt id="term-locucion-de-festivo">Locución de festivo</dt>
<dd>Esta locución se reproducirá cuando el día de hoy esté marcado como
festivo en uno de los calendarios y no se haya definido una locución
de festivo especial en dicho calendario para ese día.</dd>
<dt id="term-tipo-de-desvio-festivo">Tipo de desvío festivo</dt>
<dd>Si una llamada entra un día festivo, aparte de la locución de festivo
(si la hay), se puede realizar un desvío a un buzón de voz, a un número
externo o a una extensión interna. En el ejemplo, la llamada se
desviará los días festivos al móvil 676 676 676.</dd>
<dt id="term-locucion-fuera-horario">Locución fuera horario</dt>
<dd>Esta locución se reproducirá cuando, siendo un día no festivo, la hora
actual no esté dentro de ningunos de los horarios vinculados.</dd>
<dt id="term-tipo-de-desvio-fuera-horario">Tipo de desvío fuera horario</dt>
<dd>Lo mismo que en festivo, pero para el caso de fuera horario. En la
imagen, no se ejecutaría ningún desvío.</dd>
<dt id="term-calendarios">Calendarios</dt>
<dd>Permite seleccionar múltiples calendarios, de forma que el calendario
del filtro es la suma de todos ellos.</dd>
<dt id="term-horarios">Horarios</dt>
<dd>Permite seleccionar múltiples horarios, de forma que el horario del
filtro es la suma de todos ellos.</dd>
</dl>
<div class="admonition attention">
<p class="first admonition-title">Attention</p>
<p class="last">El día festivo tiene prevalencia sobre el fuera horario. Primero
se evalúan los calendarios, luego los horarios.</p>
</div>
<p>En la siguiente sección veremos como este filtro se asigna a los
<a class="reference internal" href="index.html#external-ddis"><span class="std std-ref">DDIs externos</span></a> que queramos, definiendo así el comportamiento de los
mismos fuera de horario y en días festivos, así como dentro de horario en el
caso de <em>setear</em> locución de bienvenida en el filtro.</p>
</div>
<span id="document-pbx_features/huntgroups"></span><div class="section" id="grupos-de-salto">
<span id="huntgroups"></span><h3>Grupos de salto<a class="headerlink" href="#grupos-de-salto" title="Permalink to this headline">¶</a></h3>
<p>Los grupos de salto nos permiten definir lógicas de <em>ringado</em> más allá de la
básica <strong>llamada a usuario</strong>.</p>
<p>Existen de varios tipos:</p>
<dl class="glossary docutils">
<dt id="term-a-todos">A todos</dt>
<dd>La llamada suena en varios terminales a la vez durante el tiempo
definido.</dd>
<dt id="term-secuencialmente-una-vez">Secuencialmente (una vez)</dt>
<dd>Suenan los usuarios definidos, en el orden definido y durante el tiempo
definido a cada uno de ellos. Al acabar la secuencia, la llamada se
cuelga.</dd>
<dt id="term-secuencialmente-infito">Secuencialmente (infito)</dt>
<dd>Suenan los usuarios definidos, en el orden definido y durante el tiempo
definido. Al acabar la secuencia, se vuelve a iniciar la secuencia.</dd>
<dt id="term-aleatoriamente">Aleatoriamente</dt>
<dd>Reparte las llamadas entre los usuarios elegidos de forma aleatoria,
sonando cada uno de ellos el tiempo acordado. Una vez que suenan todos,
la llamada se cuelga.</dd>
</dl>
<p class="rubric">Ejemplo 1: Grupo de salto <em>ringall</em></p>
<p>Creemos por ejemplo un grupo de salto que llame a la par a nuestros 2 usuarios
durante 30 segundos:</p>
<img alt="_images/huntgroup_add.png" src="_images/huntgroup_add.png" />
<p>Pulsando el icono de las personas podemos añadir a Alice y Bob a nuestro grupo
de salto:</p>
<img alt="_images/huntgroup_add2.png" src="_images/huntgroup_add2.png" />
<p class="rubric">Ejemplo 2: Grupo de salto secuencial</p>
<p>Editemos ahora este grupo de salto para que llame 10 segundos a Alice y después
15 segundos a Bob, reiniciando la secuencia si ninguno de los 2 contesta:</p>
<img alt="_images/huntgroup_add3.png" src="_images/huntgroup_add3.png" />
<p>En este caso tenemos que indicar una <strong>prioridad</strong> (los usuarios suenan de
menos a mayor prioridad) y un tiempo de <em>ringing</em>:</p>
<img alt="_images/huntgroup_add4.png" src="_images/huntgroup_add4.png" />
<div class="admonition hint">
<p class="first admonition-title">Hint</p>
<p class="last">Para que ciertas lógicas (desvíos, etc.) alcancen un <strong>Grupo de
salto</strong>, basta con crear una extensión apuntando a dicho grupo de salto y
utilizar esta extensión como destino de la lógica.</p>
</div>
<p>Creemos la extensión 200 que apunte a este grupo de salto:</p>
<img alt="_images/huntgroup_extension.png" src="_images/huntgroup_extension.png" />
</div>
<span id="document-pbx_features/ivrs"></span><div class="section" id="interactive-voice-response-ivr">
<h3>Interactive Voice Response (IVR)<a class="headerlink" href="#interactive-voice-response-ivr" title="Permalink to this headline">¶</a></h3>
<p>Un IVR es la forma habitual de realizar <strong>menús telefónicos</strong> en los que <strong>el
llamante puede decidir el destino de su llamada sin más que pulsar dígitos</strong> en
base a las locuciones que se le van reproduciendo.</p>
<div class="section" id="ivrs-genericos">
<span id="generic-ivrs"></span><h4>IVRs genéricos<a class="headerlink" href="#ivrs-genericos" title="Permalink to this headline">¶</a></h4>
<p>En los IVR genéricos el llamante marca directamente una extensión interna que
conoce (o que se le indica en la locución de bienvenida) y el sistema le pone
en contacto con dicha extensión de forma automática:</p>
<img alt="_images/ivr_generic.png" src="_images/ivr_generic.png" />
<p>Describamos cada uno de los parámetros de un IVR genérico:</p>
<dl class="glossary docutils">
<dt id="term-nombre">Nombre</dt>
<dd>Forma de referenciar el IVR</dd>
<dt id="term-timeout">Timeout</dt>
<dd>Tiempo adicional al de la locución de bienvenida que el sistema espera
a que el interlocutor marque los dígitos.</dd>
<dt id="term-locucion-de-bienvenida">Locución de bienvenida</dt>
<dd>Locución que se le presenta al llamante invitándole a marcar la
extensión con la que quiera hablar.</dd>
<dt id="term-locucion-de-exito">Locución de éxito</dt>
<dd>En caso de que la extensión marcada sea correcta, se reproducirá esta
locución (típicamente dirá algo así como &#8220;Contantando...&#8221;).</dd>
<dt id="term-expresion-regular-lista-negra">Expresión regular lista negra</dt>
<dd>Si queremos que alguna extensión interna no sea accesible desde el IVR,
basta con añadirla aquí utilizando expresiones regulares. En el
ejemplo, las extensiones 105 y 106 no serían accesibles desde el IVR y
marcarlas provocaría que se activase la <strong>Configuración de Error</strong>.</dd>
<dt id="term-configuracion-no-contesta">Configuración No contesta</dt>
<dd>En caso de que la extensión destino no conteste en el tiempo indicado,
se reproduce la locución indicada y se desvía al número externo,
extensión interna o buzón seleccionado.</dd>
<dt id="term-configuracion-error">Configuración Error</dt>
<dd>Si lo que ha marcado el llamante no es válido (o no ha marcado nada),
se reproduce la locución indicada y se desvía la llamada al número
externo, extensión interna o buzón seleccionado.</dd>
</dl>
</div>
<div class="section" id="ivrs-a-medida">
<span id="custom-ivrs"></span><h4>IVRs a medida<a class="headerlink" href="#ivrs-a-medida" title="Permalink to this headline">¶</a></h4>
<p>A diferencia de los IVRs genéricos en donde el llamante solo puede marcar
extensiones internas, los IVRs a medida permiten marcar dígitos que luego se
pueden convertir a lo que el administrador de empresa desee.</p>
<div class="admonition hint">
<p class="first admonition-title">Hint</p>
<p class="last">El caso más típico es el IVR que dice algo así como &#8220;Marque 1 si
quiere hablar con administración, marque 2 si quiere hablar con
informática...&#8221;</p>
</div>
<p>Los campos que se presentan son prácticamente idénticos al IVR genérico:</p>
<img alt="_images/ivr_custom.png" src="_images/ivr_custom.png" />
<p>La única diferencia es que no existe el campo <strong>Expresión regular lista
negra</strong>, que carece de sentido en este tipo de IVRs.</p>
<p>Pulsando el botón de la siguiente imagen se pueden definir las equivalencias
deseadas:</p>
<img alt="_images/ivr_custom2.png" src="_images/ivr_custom2.png" />
<p>En este caso se puede marcar 1, 2 y 3 (todo lo demás será considerado inválido
y activará la <strong>Configuración de Error</strong>):</p>
<img alt="_images/ivr_custom3.png" src="_images/ivr_custom3.png" />
<ul class="simple">
<li>1: Llamada a la extensión interna 200, creada <a class="reference internal" href="index.html#huntgroups"><span class="std std-ref">en la sección anterior</span></a> y que apunta al grupo de salto <em>Recepción</em>.</li>
<li>2: Llama a la extensión interna 101.</li>
<li>3: Desvía la llamada al número externo 676 676 676.</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Cada una de las opciones del IVR a medida permite la selección de
una locución que pisa a la <strong>locución de éxito</strong> si está definida. De esta
forma aparte de tener una locución de éxito genérica con &#8220;Contactando&#8221;
podríamos tener otra que dijera &#8220;Contactando con Administración, espere
por favor&#8221;.</p>
</div>
</div>
</div>
<span id="document-pbx_features/conference_rooms"></span><div class="section" id="salas-de-audioconferencias">
<span id="conference-rooms"></span><h3>Salas de audioconferencias<a class="headerlink" href="#salas-de-audioconferencias" title="Permalink to this headline">¶</a></h3>
<p>IvozProvider provee la funcionalidad de salas de audiconferencias que se pueden
configurar en la sección <strong>Configuración de empresa</strong> &gt; <strong>Salas de conferencias</strong>.</p>
<p class="rubric">Crear una sala de audioconferencias</p>
<p>La siguiente imagen ilustra el proceso de creación de una sala de
audioconferencias:</p>
<img alt="_images/conference_room.png" src="_images/conference_room.png" />
<dl class="glossary docutils">
<dt id="term-nombre">Nombre</dt>
<dd>Nombre por el que se referenciará la sala en otras secciones</dd>
<dt id="term-limite-de-participantes">Límite de participantes</dt>
<dd>Apartir del número especificado, no se admitirán más miembros.</dd>
<dt id="term-protegido-con-contrasena-codigo-pin">Protegido con contraseña / Código PIN</dt>
<dd>Se puede forzar al sistema a pedir un PIN para poder entrar. En caso de
activar, se puede introducir un PIN numérico.</dd>
</dl>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Para desactivar el límite de participantes, configurar su valor a 0.</p>
</div>
<p class="rubric">Asociar una extensión o un DDI externo</p>
<p>De poco sirve una sala de conferencias si no podemos meter a los participantes
a la misma.</p>
<p>Para poder meter participantes, el primer paso sería asociar una extensión
interna a la sala, para poder desvíar a la misma, transferir, etc.:</p>
<img alt="_images/conference_room_ext.png" src="_images/conference_room_ext.png" />
<p>En la siguiente sección veremos como también se puede apuntar un <a class="reference internal" href="index.html#external-ddis"><span class="std std-ref">DDI
externo</span></a> a una sala de conferencias, para meter en la sala a
gente externa a la empresa.</p>
<div class="admonition hint">
<p class="first admonition-title">Hint</p>
<p class="last">Existen otras formas de meter un participante externo a una sala de
audioconferencias sin dedicar un DDI externo: que alguien de dentro
transfiera la llamada a la extensión de la sala, acceder por medio de un
IVR, etc.</p>
</div>
</div>
<span id="document-pbx_features/external_ddis"></span><div class="section" id="ddis-externos">
<span id="external-ddis"></span><h3>DDIs externos<a class="headerlink" href="#ddis-externos" title="Permalink to this headline">¶</a></h3>
<p>En la sección preliminar <a class="reference internal" href="index.html#settingup-ddi"><span class="std std-ref">Configuring an external DDI</span></a> se describió con todo detalle la configuración necesaria para configurar un DDI externo directo a un usuario.</p>
<p>Después de explicar las secciones anteriores, podemos llevar esta configuración un poco más allá:</p>
<div class="section" id="filtro-de-entrada">
<h4>Filtro de entrada<a class="headerlink" href="#filtro-de-entrada" title="Permalink to this headline">¶</a></h4>
<p>Podemos seleccionar el <strong>Filtro de entrada externo</strong> configurado en <a class="reference internal" href="index.html#external-filters"><span class="std std-ref">la sección anterior</span></a>.</p>
<img alt="_images/ddi_edit.png" src="_images/ddi_edit.png" />
</div>
<div class="section" id="tratamientos">
<span id="routing-logics"></span><h4>Tratamientos<a class="headerlink" href="#tratamientos" title="Permalink to this headline">¶</a></h4>
<p>Vemos que tenemos más opciones aparte de enviar la llamada, una vez superado los filtros de horario y calendario (y previa locución de bienvenida), directamente a un usuario:</p>
<ul class="simple">
<li><a class="reference internal" href="index.html#huntgroups"><span class="std std-ref">Grupos de salto</span></a></li>
</ul>
<img alt="_images/ddi_edit2.png" src="_images/ddi_edit2.png" />
<ul class="simple">
<li><a class="reference internal" href="index.html#generic-ivrs"><span class="std std-ref">IVR Genérico</span></a></li>
</ul>
<img alt="_images/ddi_edit3.png" src="_images/ddi_edit3.png" />
<ul class="simple">
<li><a class="reference internal" href="index.html#custom-ivrs"><span class="std std-ref">IVR a medida</span></a></li>
</ul>
<img alt="_images/ddi_edit4.png" src="_images/ddi_edit4.png" />
<ul class="simple">
<li><a class="reference internal" href="index.html#conference-rooms"><span class="std std-ref">Salas de audioconferencias</span></a></li>
</ul>
<img alt="_images/ddi_edit5.png" src="_images/ddi_edit5.png" />
<div class="admonition hint">
<p class="first admonition-title">Hint</p>
<p class="last">También podemos apuntar el DDI a un <a class="reference internal" href="index.html#faxing-system"><span class="std std-ref">fax virtual</span></a>, pero esto se verá en el siguiente bloque.</p>
</div>
</div>
</div>
</div>
<div class="toctree-wrapper compound">
<span id="document-pbx_features/call_captures"></span><div class="section" id="capturas-de-llamada">
<span id="capture-groups"></span><h3>Capturas de llamada<a class="headerlink" href="#capturas-de-llamada" title="Permalink to this headline">¶</a></h3>
<p>Se entiende por captura de llamada <strong>la acción de un usuario que escucha</strong> (o
se entera de otro modo, vía panel de supervisión, etc.) <strong>que una extensión
está sonando y, desde su terminal, roba dicha llamada</strong>.</p>
<p>IvozProvider soporta dos tipos de captura de llamadas:</p>
<dl class="glossary docutils">
<dt id="term-captura-de-llamadas-directa">Captura de llamadas directa</dt>
<dd>En las capturas de llamadas directas el usuario indica un código que
incluye la extensión del teléfono cuya llamada quiere <em>robar</em>. Si el
código fuera *95, por ejemplo, marcaría *95101 para capturar una
llamada que esté sonando en la extensión 101.</dd>
<dt id="term-captura-de-llamadas-indirecta">Captura de llamadas indirecta</dt>
<dd>En las capturas de llamadas indirectas, en cambio, el usuario indica un
código y el sistema busca qué teléfono está sonando dentro de sus
grupos de captura.</dd>
</dl>
<div class="section" id="grupos-de-captura-de-llamada">
<h4>Grupos de captura de llamada<a class="headerlink" href="#grupos-de-captura-de-llamada" title="Permalink to this headline">¶</a></h4>
<p>Para poder realizar <strong>capturas de llamada indirectas</strong>, el usuario que captura
tiene que pertener al mismo grupo de captura que el usuario al que pretende
capturar.</p>
<p>La sección <strong>Grupos de captura de llamada</strong> nos permite crear estos grupos y
decir qué usuarios pertenecen a ellos:</p>
<img alt="_images/capture_groups.png" src="_images/capture_groups.png" />
<p>Como vimos en la sección de <a class="reference internal" href="index.html#users"><span class="std std-ref">Usuarios</span></a>, también se puede editar un usuario
para editar los grupos de captura a los que pertenece.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Un usuario puede pertenecer a más de un grupo de captura, el sistema
tendrá en cuenta todos sus grupos.</p>
</div>
<p>Desde el momento en el que un usuario está en un grupo de captura, puede
empezar a intentar capturar de forma indirecta pero para ello necesita saber el
código de captura.</p>
</div>
<div class="section" id="codigo-de-captura-de-llamada">
<h4>Código de captura de llamada<a class="headerlink" href="#codigo-de-captura-de-llamada" title="Permalink to this headline">¶</a></h4>
<p>IvozProvider permite definir los códigos de captura a 2 niveles:</p>
<ul class="simple">
<li>A nivel de marca en <strong>Configuración de Marca</strong> &gt; <strong>Servicios</strong>.</li>
<li>A nivel de empresa en <strong>Configuración de Empresa</strong> &gt; <strong>Servicios</strong>.</li>
</ul>
<p>Esto permite que el administrador de marca pueda definir unos códigos genéricos
para todas sus empresas y que, las empresas que deseen utilizar otros códigos,
puedan redefinirlos.</p>
<p><a class="reference internal" href="index.html#services"><span class="std std-ref">La siguiente sección</span></a> explica todo lo relativo a servicios,
que engloba los códigos de captura y otros servicios adicionales a los que se
accede marcando códigos que comienzan por *.</p>
</div>
</div>
<span id="document-pbx_features/services"></span><div class="section" id="servicios-adicionales">
<span id="services"></span><h3>Servicios adicionales<a class="headerlink" href="#servicios-adicionales" title="Permalink to this headline">¶</a></h3>
<p>Existen <strong>servicios especiales</strong> a los que se accede <strong>marcando códigos</strong>
especiales <strong>desde un terminal</strong> de usuario <strong>cuando éste está en reposo</strong>.</p>
<div class="admonition danger">
<p class="first admonition-title">Danger</p>
<p class="last">Los servicios que se definen en esta sección <strong>no son accesibles
en medio de una conversación</strong>. Se activan <strong>llamando</strong> a los códigos que
se mencionarán, no marcándolos en medio de una conversación.</p>
</div>
<div class="section" id="listado-de-codigos-a-nivel-global">
<h4>Listado de códigos a nivel global<a class="headerlink" href="#listado-de-codigos-a-nivel-global" title="Permalink to this headline">¶</a></h4>
<p>En el momento de realizar esta documentación, existen los siguientes
<strong>servicios especiales</strong> visibles en la sección <strong>Gestión general</strong> &gt;
<strong>Servicios</strong>:</p>
<img alt="_images/services_god.png" src="_images/services_god.png" />
<dl class="glossary docutils">
<dt id="term-captura-directa">Captura Directa</dt>
<dd>Es el servicio que permite capturar metiendo el código que se asigne
seguido de la extensión del teléfono a capturar.</dd>
<dt id="term-captura-de-grupo">Captura de Grupo</dt>
<dd>Es el servicio que permite capturar el teléfono que esté sonando
dentro de tu(s) grupo(s) de captura.</dd>
<dt id="term-consultar-el-buzon-de-voz">Consultar el buzón de voz</dt>
<dd>Este servicio permite acceder a un menú de voz que te presenta los
mensajes de voz nuevos, viejos, etc. Es una alternativa a la recepción
de mensajes de voz vía correo electrónico.</dd>
</dl>
<p>A medida que la solución vaya evolucionando y surjan servicios nuevos,
aparecerán en este listado para que el operador global sepa de su existencia
y lo comunique a sus operadores de marca.</p>
<div class="admonition attention">
<p class="first admonition-title">Attention</p>
<p class="last">Este listado determina los servicios disponibles y los códigos
por defecto de las <strong>nuevas marcas</strong>.</p>
</div>
<div class="admonition hint">
<p class="first admonition-title">Hint</p>
<p class="last">Cambiar un código solo afecta a las marcas que se creen tras el
cambio.</p>
</div>
</div>
<div class="section" id="definicion-de-servicios-y-codigos-a-nivel-de-marca">
<h4>Definición de servicios y códigos a nivel de marca<a class="headerlink" href="#definicion-de-servicios-y-codigos-a-nivel-de-marca" title="Permalink to this headline">¶</a></h4>
<p>La sección <strong>Configuración de Marca ** &gt; **Servicios</strong> permite al operador
de marca:</p>
<ul class="simple">
<li>Redefinir el código de acceso por defecto a dichos servicios para las
empresas que a su vez no lo redefinan.</li>
<li>Borrar servicios que no quieran que puedan utilizar sus empresas.</li>
</ul>
<p>Por defecto este listado aparece con todas los servicios y los códigos
configurados a nivel Global:</p>
<img alt="_images/services_brand_list.png" src="_images/services_brand_list.png" />
<div class="admonition attention">
<p class="first admonition-title">Attention</p>
<p class="last">Este listado determina los servicios disponibles y los códigos
por defecto de las <strong>nuevas empresas</strong>.</p>
</div>
<div class="admonition hint">
<p class="first admonition-title">Hint</p>
<p class="last">Cambiar un código solo afecta a las empresas que se creen tras el
cambio. Borrar un servicio hace que no esté disponible para ninguna empresa
de la marca.</p>
</div>
</div>
<div class="section" id="definicion-de-codigos-a-nivel-de-empresa">
<h4>Definición de códigos a nivel de empresa<a class="headerlink" href="#definicion-de-codigos-a-nivel-de-empresa" title="Permalink to this headline">¶</a></h4>
<p>Cada empresa puede <em>pisar</em> los valores por defecto asignados por su <em>operador
de marca</em> accediendo a <strong>Configuración de Empresa</strong> &gt; <strong>Servicios</strong> y
cambiando el código asignado.</p>
<p class="rubric">Empresa que quiere capturar con ** en lugar de con *95:</p>
<img alt="_images/services_company_edit.png" src="_images/services_company_edit.png" />
<div class="admonition hint">
<p class="first admonition-title">Hint</p>
<p class="last">Los servicios que el <em>administrador de empresa</em> borre no podrán ser
utilizados por sus usuarios.</p>
</div>
</div>
</div>
<span id="document-pbx_features/call_recording"></span><div class="section" id="grabacion-de-llamadas">
<span id="call-recordings"></span><h3>Grabación de llamadas<a class="headerlink" href="#grabacion-de-llamadas" title="Permalink to this headline">¶</a></h3>
<p>IvozProvider permite grabar las llamadas que se cursan en 2 modalidades
distintas:</p>
<ul class="simple">
<li><strong>Grabación automática</strong> para llamadas desde/hacia cierto <a class="reference internal" href="index.html#external-ddis"><span class="std std-ref">DDI externo</span></a>.</li>
<li><strong>Grabación bajo demanda</strong> solicitada por un usuario en medio de una
conversación.</li>
</ul>
<div class="section" id="grabacion-automatica-por-ddi">
<h4>Grabación automática por DDI<a class="headerlink" href="#grabacion-automatica-por-ddi" title="Permalink to this headline">¶</a></h4>
<p>En el caso de grabaciones automáticas por DDI, <strong>se graba toda la
conversación</strong>: desde el principio hasta el final.</p>
<p>Se distinguen 2 casos:</p>
<ul class="simple">
<li><strong>Llamadas entrantes a un DDI</strong>: la grabación seguirá mientras la parte
externa de la llamada permanezca en la conversación.</li>
<li><strong>Llamadas salientes utilizando un DDI</strong> como <a class="reference internal" href="index.html#external-ddis"><span class="std std-ref">DDI saliente</span></a>: mientras el interlocutor externo permanezca en la
conversación, la grabación sigue.</li>
</ul>
<div class="admonition attention">
<p class="first admonition-title">Attention</p>
<p class="last">El hecho de que <strong>mientras el interlocutor permanezca en la
llamada la grabación continúe</strong>, hace que no importe cuántes veces se
transfiera la llamada de un usuario a otro, la grabación contendrá toda la
conversación (desde el punto de vista del participante externo).</p>
</div>
<p class="rubric">Grabar todas las llamadas de un DDI</p>
<p>Basta con editar el DDI en cuestión y habilitar las grabaciones:</p>
<img alt="_images/recordings_ddi.png" src="_images/recordings_ddi.png" />
<p>Existen 4 opciones:</p>
<ul class="simple">
<li>Desactivar la grabación</li>
<li>Activarla para llamadas entrantes a dicho DDI</li>
<li>Activarla para llamadas salientes que presente dicho DDI</li>
<li>Activarla para ambas</li>
</ul>
</div>
<div class="section" id="grabacion-bajo-demanda">
<h4>Grabación bajo demanda<a class="headerlink" href="#grabacion-bajo-demanda" title="Permalink to this headline">¶</a></h4>
<p>La grabación bajo demanda u <em>on-demand</em> la tiene que activar el <em>operador de
marca</em> para las empresas que la necesiten, sin más que editar su empresa y
configurar el código deseado:</p>
<img alt="_images/recordings_ondemand.png" src="_images/recordings_ondemand.png" />
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">A diferencia de los <a class="reference internal" href="index.html#services"><span class="std std-ref">Servicios</span></a> comentado en la
sección anterior, la funcionalidad de grabación bajo demanda se activa en
mitad de una conversación.</p>
</div>
<div class="section" id="activacion-por-medio-de-tecla-record">
<h5>Activación por medio de tecla <em>Record</em><a class="headerlink" href="#activacion-por-medio-de-tecla-record" title="Permalink to this headline">¶</a></h5>
<p>Los terminales <em>Yealink</em> soportan el envío de mensajes <a class="reference external" href="https://tools.ietf.org/html/rfc6086">SIP INFO</a> con una cabecera <em>Record</em> (ver
<a class="reference external" href="http://www.yealink.com/Upload/document/UsingCallRecordingFeatureonYealinkPhones/UsingCallRecordingFeatureonYealinkSIPT2XPphonesRev_610-20561729764.pdf">referencia</a>).
No es un estándar, pero al ser <em>Yealink</em> uno de los modelos soportados,
IvozProvider incluye soporte para la activación de grabación bajo demanda de
esta forma.</p>
<div class="admonition important">
<p class="first admonition-title">Important</p>
<p class="last">El código seleccionado no influye en este caso, pero <strong>la
empresa sí que tiene que tener las grabaciones bajo demanda activadas</strong>.</p>
</div>
<p>La activación de las grabaciones es muy simple en este caso, basta con pulsar
la tecla y el sistema inicia la grabación.</p>
</div>
<div class="section" id="activacion-por-medio-de-transferencia-ciega-frustrada">
<h5>Activación por medio de transferencia ciega frustrada<a class="headerlink" href="#activacion-por-medio-de-transferencia-ciega-frustrada" title="Permalink to this headline">¶</a></h5>
<p>Existe otra forma de acceder a esta funcionalidad para los terminales que no
tengan soporte para el método anterior.</p>
<div class="admonition danger">
<p class="first admonition-title">Danger</p>
<p class="last">Este método de acceder a la funcionalidad es una forma imaginativa
de hacerla accesible para terminales sin soporte nativo de tecla <em>Record</em>
(que es el método recomendado). En función del terminal en cuestión y de la
configuración del mismo, resultará más o menos cómodo utilizar la
funcionalidad (tecla rápida de transferencia ciega, no retener al
interlocutor, etc.).</p>
</div>
<p>Los pasos a seguir en este método alternativo e imaginativo son los siguientes:</p>
<ul class="simple">
<li>No se activa marcando el código en medio de la conversación.</li>
<li>Se activa iniciando una transferencia ciega al código configurado.</li>
<li>El sistema rechazará la transferencia e iniciará la grabación.</li>
<li>El usuario podrá volver a la conversación que tenía (si es que su terminal no
ha vuelto solo) y seguir hablando.</li>
</ul>
<p class="rubric">¿Por qué esta forma tan <em>peculiar</em> de activar la grabación y no por
medio de tonos normales?</p>
<p>El motivo de activar la grabación por medio de una transferencia ciega
frustrada se debe a la <a class="reference internal" href="index.html#architecture"><span class="std std-ref">[P] Platform general architecture</span></a> y, más concretamente, al
<a class="reference internal" href="index.html#audioflow"><span class="std std-ref">flujo de audio RTP</span></a>.</p>
<p>Lo habitual suele ser activar servicios por medio de pulsaciones en medio de
la llamada (lo que se conoce por <a class="reference external" href="https://es.wikipedia.org/wiki/Marcaci%C3%B3n_por_tonos">tonos DTMF</a>). Estos tonos suelen
viajar por el mismo camino del audio (siguiendo el <a class="reference external" href="https://tools.ietf.org/html/rfc4733">RFC 4733</a> o como sonido audible).</p>
<p>IvozProvider utiliza la transmisión de estos tonos siguiendo el <a class="reference external" href="https://tools.ietf.org/html/rfc4733">RFC 4733</a> y, por tanto, dichos paquetes de audio
pasan por los <em>media-relays</em>, que se limitan a reenviar el audio sin analizar
su contenido. Al no analizar su contenido, no pueden detectar las pulsaciones y
activar lógicas.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Esta decisión de diseño es la que permite escalar la solución y ser
capaz de gestionar cientos de miles de llamadas concurrentes.</p>
</div>
<p>Al realizar una transferencia ciega, en cambio, se produce señalización SIP
dentro de un diálogo (en concreto, un <a class="reference external" href="https://tools.ietf.org/html/rfc3515">REFER</a>) y sí que es posible activar lógicas de
este estilo, ya que la señalización sigue <cite>otro camino &lt;signallingflow&gt;</cite> que
incluye a los elementos con lógica (servidores de aplicación y <em>proxies</em>).</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">La grabación bajo demanda graba la llamada desde que se activa
hasta que el usuario que la activó desaparece de la misma.</p>
</div>
<div class="admonition important">
<p class="first admonition-title">Important</p>
<p class="last">No existe la funcionalidad de parar la grabación,
independientemente del método elegido para activarla.</p>
</div>
</div>
</div>
<div class="section" id="listado-de-grabaciones">
<h4>Listado de grabaciones<a class="headerlink" href="#listado-de-grabaciones" title="Permalink to this headline">¶</a></h4>
<p>El <em>administrador de empresa</em> puede acceder a las grabaciones realizadas por
medio de la sección <strong>Configuración de Empresa</strong> &gt; <strong>Grabaciones</strong>:</p>
<img alt="_images/recordings_list.png" src="_images/recordings_list.png" />
<p>Haciendo clic en una de ellas, podría escucharla desde la <em>web</em> o descargársela
en formato MP3:</p>
<img alt="_images/recordings_list2.png" src="_images/recordings_list2.png" />
<p>En el caso de una grabación bajo demanda, se indica qué usuario la inició:</p>
<img alt="_images/recordings_list3.png" src="_images/recordings_list3.png" />
</div>
</div>
</div>
</div>
</div>
<div class="toctree-wrapper compound">
<span id="document-billing_and_invoices/index"></span><div class="section" id="tarificacion-y-facturacion">
<h2>Tarificación y facturación<a class="headerlink" href="#tarificacion-y-facturacion" title="Permalink to this headline">¶</a></h2>
<p>En este bloque se tratará un tema de primordial importancia para los
administradores de marca:</p>
<ul class="simple">
<li>Crear planes de precio para poner precio a las llamadas de los usuarios.</li>
<li>Crear facturas que recojan el detalle y el consumo de sus empresas.</li>
</ul>
<p>Pare ello, abordaremos las siguientes cuestiones:</p>
<div class="toctree-wrapper compound">
<span id="document-billing_and_invoices/call_registry"></span><div class="section" id="historico-de-llamadas">
<span id="call-registry"></span><h3>Histórico de llamadas<a class="headerlink" href="#historico-de-llamadas" title="Permalink to this headline">¶</a></h3>
<p>Los históricos de llamadas muestran todas las llamadas de la plataforma y se
muestran a 3 niveles:</p>
<ul class="simple">
<li><strong>Gestión general</strong> &gt; <strong>Histórico de llamadas</strong></li>
<li><strong>Configuración de Marca</strong> &gt; <strong>Histórico de llamadas</strong></li>
<li><strong>Configuración de Empresa</strong> &gt; <strong>Histórico de llamadas</strong></li>
</ul>
<p>En cada uno de los niveles se muestran las llamadas filtradas convenientemente.</p>
<p class="rubric">A nivel global (god)</p>
<p>Muestra todas las llamadas de la plataforma, indicando la marca y la empresa de
cada una de ellas:</p>
<img alt="_images/call_registry_god.png" src="_images/call_registry_god.png" />
<p class="rubric">A nivel de marca</p>
<p>Muestra todas las llamadas de la marca emulada, indicando la empresa de cada
una de ellas:</p>
<img alt="_images/call_registry_brand.png" src="_images/call_registry_brand.png" />
<p class="rubric">A nivel de empresa</p>
<p>Muestra todas las llamadas de la empresa emulada:</p>
<img alt="_images/call_registry_company.png" src="_images/call_registry_company.png" />
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">El exportador a <a class="reference external" href="https://es.wikipedia.org/wiki/CSV">CSV</a> permite
exportar el listado para su posterior almacenamiento o procesado.</p>
</div>
<div class="admonition hint">
<p class="first admonition-title">Hint</p>
<p class="last">Si se accede a una llamada concreta, se muestra información adicional
sobre la misma. Esta información adicional depende del nivel (<em>god</em>, marca o
empresa) y provee información sobre desvíos, transferencias, etc.</p>
</div>
</div>
<span id="document-billing_and_invoices/billable_calls"></span><div class="section" id="llamadas-facturables">
<span id="billable-calls"></span><h3>Llamadas facturables<a class="headerlink" href="#llamadas-facturables" title="Permalink to this headline">¶</a></h3>
<p>Los listados de llamadas de las secciones <strong>Llamadas facturables</strong> muestran
solo las <strong>llamadas que implican coste</strong>.</p>
<div class="admonition important">
<p class="first admonition-title">Important</p>
<p class="last">La gran diferencia respecto a las llamadas del
<a class="reference internal" href="index.html#call-registry"><span class="std std-ref">Histórico de llamadas</span></a> es que todas las que aparecen aquí implican coste (no
aparecen, por tanto, llamadas internas, etc.)</p>
</div>
<p>Se muestra el coste asociado a las llamadas (una vez calculado) y, dado que las
empresas son notificadas de sus llamadas por medio de facturas emitidas por el
<em>operador de marca</em>, solo se existe a dos niveles:</p>
<ul class="simple">
<li>A nivel global (<em>god</em>).</li>
<li>A nivel de marca.</li>
</ul>
<p>Estos listados muestran la siguiente información:</p>
<dl class="glossary docutils">
<dt id="term-fecha">Fecha</dt>
<dd>Fecha y hora del establecimiento de la llamada.</dd>
<dt id="term-marca">Marca</dt>
<dd>Solo visible a nivel <em>god</em>, indica la marca de la empresa en cuestión.</dd>
<dt id="term-compania">Compañía</dt>
<dd>Empresa responsable de la llamada.</dd>
<dt id="term-destino">Destino</dt>
<dd>Número externo al que se ha llamado.</dd>
<dt id="term-patron-de-destino">Patrón de destino</dt>
<dd>Indica el <a class="reference internal" href="index.html#price-pattern"><span class="std std-ref">patrón de precio</span></a> en base al cual se ha
puesto precio a la llamada.</dd>
<dt id="term-duracion">Duración</dt>
<dd>Indica cuánto ha durado la llamada.</dd>
<dt id="term-tarificado-si-no">Tarificado (sí/no)</dt>
<dd>Indica si el proceso que pone precio a las llamadas ha calculado el
precio de esta llamada concreta.</dd>
<dt id="term-precio">Precio</dt>
<dd>Coste calculado para la llamada.</dd>
<dt id="term-plan-de-precio">Plan de precio</dt>
<dd><a class="reference internal" href="index.html#price-plan"><span class="std std-ref">Plan de precio</span></a> en base al cual se ha puesto precio
a la llamada.</dd>
<dt id="term-contrato-de-peering">Contrato de peering</dt>
<dd>Indica por qué <a class="reference internal" href="index.html#peering-contracts"><span class="std std-ref">Contrato de peering</span></a> ha salido
la llamada.</dd>
<dt id="term-factura">Factura</dt>
<dd>Indica si la llamada está incluida en alguna <a class="reference internal" href="index.html#invoices"><span class="std std-ref">factura</span></a>.</dd>
<dt id="term-tipo-entrante-saliente">Tipo (entrante/saliente)</dt>
<dd>Dado que ciertas llamadas entrantes pueden implicar coste (ver
<a class="reference internal" href="index.html#bill-inbound"><span class="std std-ref">tarificación de llamadas entrantes</span></a>), indica si la
llamada es entrante o saliente.</dd>
</dl>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Las llamadas aparecen en este listado en cuanto se cuelgan. Pasados
unos minutos, el proceso que pone precios a las llamadas habrá tarificado la
llamada (<em>Tarificado</em> igual a &#8216;Sí&#8217;) y tendremos disponible el <strong>Precio</strong>
calculado.</p>
</div>
</div>
<span id="document-billing_and_invoices/pricing_plans"></span><div class="section" id="planes-de-precio">
<h3>Planes de precio<a class="headerlink" href="#planes-de-precio" title="Permalink to this headline">¶</a></h3>
<p>En la sección <a class="reference internal" href="index.html#noplan-nocall"><span class="std std-ref">Sin plan de precio, no hay llamada</span></a> se hacía una introducción bastante completa
sobre el proceso manual de creación de un plan de precios y los conceptos más
importantes:</p>
<ul>
<li><p class="first"><strong>Un plan de precios agrupa un listado de patrones de precio (prefijos de
llamada) con sus detalles de precio</strong>:</p>
<blockquote>
<div><ul class="simple">
<li>Precio por minuto</li>
<li>Establecimiento de llamada</li>
<li>Facturación por segundos / minutos /etc.</li>
</ul>
</div></blockquote>
</li>
<li><p class="first">Un plan de precios se asocia a una empresa concreta, indicando el período de
validez de dicho plan.</p>
</li>
<li><p class="first">Una empresa podía tener varios planes de precios en un momento concreto para
una llamada concreta.</p>
</li>
<li><p class="first">En este último caso, el coste de la llamada se calcularía utilizando el plan
de precio de menor métrica.</p>
</li>
</ul>
<div class="section" id="creacion-manual">
<h4>Creación manual<a class="headerlink" href="#creacion-manual" title="Permalink to this headline">¶</a></h4>
<p>La <a class="reference internal" href="index.html#price-plan"><span class="std std-ref">creación manual de un plan de precio</span></a> implicaba la
creación previa de un <a class="reference internal" href="index.html#price-pattern"><span class="std std-ref">patrón de precio</span></a>.</p>
<p>En ese momento, es posible que el futuro administrador de marca se haya dado
cuenta de la titánica tarea que implicaría crear miles de patrones de precio (254 países por las distintas redes móviles, fijos, numeraciones especiales, etc.) para luego poder agruparlos en un plan de precios.</p>
<p>Es por ello que el proceso de creación de planes y patrones de precio se
realiza partiendo de un <a class="reference external" href="https://es.wikipedia.org/wiki/CSV">CSV</a>.</p>
</div>
<div class="section" id="importacion-via-csv">
<h4>Importación vía CSV<a class="headerlink" href="#importacion-via-csv" title="Permalink to this headline">¶</a></h4>
<p>El primer paso es crear un plan de precios vacío sobre el que importar nuestros
precios (sección <strong>Configuración de marca</strong> &gt; <strong>Planes de precio</strong>):</p>
<img alt="_images/pricing_plans_add.png" src="_images/pricing_plans_add.png" />
<p>Accedemos al listado (vacío) del plan de precio que acabamos de crear:</p>
<img alt="_images/pricing_plans_add_price.png" src="_images/pricing_plans_add_price.png" />
<p>El botón clave para este proceso de importación masiva es el siguiente:</p>
<img alt="_images/pricing_plan_csv.png" src="_images/pricing_plan_csv.png" />
<p>Una vez elegido el archivo a importar, se nos presenta la siguiente ventana:</p>
<img alt="_images/pricing_plan_csv3.png" src="_images/pricing_plan_csv3.png" />
<p>En esta ventana podríamos seleccionar qué contiene cada columna, en caso de no
haber creado el <a class="reference external" href="https://es.wikipedia.org/wiki/CSV">CSV</a> en el formato
recomendado. Del mismo modo, se nos ofrece la posibilidad de ignorar la primera
línea, en caso de que incluya los nombres de las columnas en lugar de datos.</p>
<div class="admonition hint">
<p class="first admonition-title">Hint</p>
<p class="last">El proceso de importación se realiza en segundo plano, permitiendo al
administrador de marca seguir configurando otros aspectos de la plataforma
mientras se completa.</p>
</div>
<div class="section" id="formato-csv">
<h5>Formato CSV<a class="headerlink" href="#formato-csv" title="Permalink to this headline">¶</a></h5>
<p>A pesar de que la ventana anterior nos permite importar archivos <a class="reference external" href="https://es.wikipedia.org/wiki/CSV">CSV</a> en distintos formatos, lo mejor es
importar un archivo en el formato adecuado para simplicar este proceso.</p>
<p>El formato del archivo <a class="reference external" href="https://es.wikipedia.org/wiki/CSV">CSV</a> está
explicado en la propia sección de ayuda contextual, que incluye un enlace para
poder descargar un archivo de ejemplo:</p>
<img alt="_images/pricing_plan_csv2.png" src="_images/pricing_plan_csv2.png" />
<p>El formato, por lo tanto, tiene que ser:</p>
<ul class="simple">
<li>Nombre del patrón de precio</li>
<li>Descripción del patrón de precio</li>
<li>Prefijo</li>
<li>Precio por minuto</li>
<li>Precio de establecimiento</li>
<li>Período de facturación</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Los números decimales tienen que estar entrecomillados con comillas
dobles y tienen que usar la coma como separador decimal.</p>
</div>
<div class="admonition important">
<p class="first admonition-title">Important</p>
<p class="last">El sistema de importación creará los patrones de precio que sean
necesarios. Si ya existe un patrón de precios con ese prefijo, no se creará,
simplemente se vinculará.</p>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p><strong>El período de facturación determina cada cuántos segundos se
incrementa el precio de la llamada</strong>.</p>
<blockquote class="last">
<div><ul class="simple">
<li>Si se pone a 1, implica una tarificación por segundos y cada segundo
implicará un coste que será el <em>precio por minuto</em> dividido entre 60.</li>
<li>Para facturación por minutos, habrá que poner 60 en este campo y,
cada bloque de 1 minuto se sumará el <em>precio por minuto</em> al precio final.</li>
</ul>
</div></blockquote>
</div>
<p>Una vez completada la importación, solo faltaría asociar el nuevo plan de
precios a las empresas que queramos, siguiendo <a class="reference internal" href="index.html#pricing-plan-to-company"><span class="std std-ref">el procedimiento explicado
en el bloque anterior</span></a>.</p>
</div>
</div>
</div>
<span id="document-billing_and_invoices/bill_a_call"></span><div class="section" id="tarificacion-de-llamadas">
<h3>Tarificación de llamadas<a class="headerlink" href="#tarificacion-de-llamadas" title="Permalink to this headline">¶</a></h3>
<dl class="docutils">
<dt>Tarificar una llamada es la <strong>acción de poner precio</strong> a una llamada que implica</dt>
<dd>coste.</dd>
</dl>
<div class="section" id="tarificacion-automatica">
<h4>Tarificación automática<a class="headerlink" href="#tarificacion-automatica" title="Permalink to this headline">¶</a></h4>
<p>Tal y como se ha explicado con anterioridad, el proceso de tarificación es
automático:</p>
<ul>
<li><p class="first">En el momento en el que una llamada se va a establecer, se verifica que se
vaya a poder tarificar.</p>
<blockquote>
<div><ul class="simple">
<li>Si no se va a poder tarificar atendiendo a los planes de precios activos
para la empresa, la llamada no se cursará.</li>
</ul>
</div></blockquote>
</li>
<li><p class="first">En el momento en el que una llamada que implique coste se cuelga, aparece en
el listado de <a class="reference internal" href="index.html#billable-calls"><span class="std std-ref">Llamadas facturables</span></a>.</p>
</li>
<li><p class="first">Pasados unos minutos, el proceso tarificador evaluará las llamadas
tarificables sin coste y rellenará los siguientes campos del registro
anterior:</p>
<blockquote>
<div><ul class="simple">
<li>Precio</li>
<li>Plan de precio</li>
<li>Patrón de destino (que es en realidad el patrón de precio)</li>
<li>Tarificado a &#8216;Sí&#8217;</li>
</ul>
</div></blockquote>
</li>
</ul>
</div>
<div class="section" id="retarificacion-manual">
<h4>Retarificación manual<a class="headerlink" href="#retarificacion-manual" title="Permalink to this headline">¶</a></h4>
<p>Puede ocurrir que una llamada se tarifique de forma incorrecta, por múltiples
motivos:</p>
<ul class="simple">
<li>Plan de precio importado con una errata.</li>
<li>Múltiples planes de precios con métricas incorrectas.</li>
<li>Plan de precio adicional sin vincular.</li>
<li>Etc.</li>
</ul>
<p>Para estos casos, el <em>administrador de marca</em> puede re-tarificar las llamadas
que considere mal tarificadas.</p>
<div class="admonition important">
<p class="first admonition-title">Important</p>
<p class="last">Retarificar una llamada consiste en volver a calcular el precio
de la misma. Lógicamente, la retarificación se calculará en el momento
solicitado, teniendo en cuenta las configuración actual de planes de precio
(y no las del momento del establecimiento de la llamada).</p>
</div>
<p>Para retarificar, basta con seleccionar las llamadas en <strong>Configuración de
Marca</strong> &gt; <strong>Llamada facturables</strong> y presionar el botón <strong>Tarificar llamadas</strong>:</p>
<img alt="_images/retarificate.png" src="_images/retarificate.png" />
<div class="admonition error">
<p class="first admonition-title">Error</p>
<p class="last"><strong>No se puede retarificar una llamada que esté incluida en una
factura</strong>. Es decir, si la llamada seleccionada tiene el campo <strong>Factura</strong>
con valor, habrá que borrar esta factura previamente. El motivo es estar
seguros que no existen facturas con llamadas mal tarificadas: si retarificas
una llamada, regeneras la factura que la contiene.</p>
</div>
</div>
</div>
<span id="document-billing_and_invoices/invoices"></span><div class="section" id="generacion-de-facturas">
<span id="invoices"></span><h3>Generación de facturas<a class="headerlink" href="#generacion-de-facturas" title="Permalink to this headline">¶</a></h3>
<p>El objetivo final de todo el proceso de facturación es generar facturas que
incluyan las llamadas con coste de una empresa concreta.</p>
<div class="section" id="plantillas-de-facturas">
<h4>Plantillas de facturas<a class="headerlink" href="#plantillas-de-facturas" title="Permalink to this headline">¶</a></h4>
<p>Antes de generar una factura de ejemplo, es importante entender que las
facturas generadas utilizan unas plantillas que permiten su modificación.</p>
<div class="admonition hint">
<p class="first admonition-title">Hint</p>
<p class="last">De este modo, cada <em>operador de marca</em> puede crear plantillas con los
datos deseados, la estética deseada, añadir logos y hasta gráficas de
consumo.</p>
</div>
<p>Todo ello se realiza utilizando la librería <a class="reference external" href="https://github.com/psliwa/PHPPdf">PHPPdf</a>.</p>
<p>La ayuda contextual de la sección <strong>Configuración de Marca</strong> &gt; <strong>Plantillas de
facturas</strong> incluye una explicación resumida del proceso de creación de
plantillas. En la <a class="reference external" href="https://github.com/psliwa/PHPPdf">página oficial de PHPPdf</a> se puede encontrar más información.</p>
<p>Por defecto, IvozProvider incluye las siguientes plantillas de ejemplo (en la
ayuda contextual se pueden encontrar enlaces a las mismas):</p>
<img alt="_images/invoices_templates.png" src="_images/invoices_templates.png" />
</div>
<div class="section" id="costes-fijos">
<h4>Costes fijos<a class="headerlink" href="#costes-fijos" title="Permalink to this headline">¶</a></h4>
<p>Los costes fijos son un concepto fijo que se pueden añadir a las facturas que
utilicen plantillas que tengan en cuenta costes fijos.</p>
<p>Sirva la siguiente imagen de ejemplo (sección <strong>Costes Fijos</strong>):</p>
<img alt="_images/fixed_costs.png" src="_images/fixed_costs.png" />
<p>A la hora de generar una factura, como se verá más adelante, se podrá indicar
cuáles de estos conceptos se incluyen en la factura (y en qué cantidades).</p>
</div>
<div class="section" id="creacion-de-una-factura">
<h4>Creacion de una factura<a class="headerlink" href="#creacion-de-una-factura" title="Permalink to this headline">¶</a></h4>
<p>La sección <strong>Facturas</strong> es la que permite al <strong>operador de marca</strong> generar
facturas para emitir a sus empresas.</p>
<p>Añadimos una factura nueva para explicar el proceso:</p>
<img alt="_images/invoice_add.png" class="align-center" src="_images/invoice_add.png" />
<dl class="glossary docutils">
<dt id="term-numero">Número</dt>
<dd>Será incluído en la factura y representa el número de factura</dd>
<dt id="term-empresa">Empresa</dt>
<dd>Empresa para la cual estamos generando la factura</dd>
<dt id="term-fecha-inicio-fin">Fecha inicio/fin</dt>
<dd>Tramo temporal cuyas llamadas queremos tener en cuenta</dd>
<dt id="term-impuesto">Impuesto</dt>
<dd>Impuesto a añadir al coste total calculado</dd>
<dt id="term-plantilla">Plantilla</dt>
<dd>Plantilla que queremos utilizar para generar esta factura</dd>
</dl>
<p>Añadamos ahora unos costes fijos a esta factura concreta pulsando:</p>
<img alt="_images/invoice_add2.png" class="align-center" src="_images/invoice_add2.png" />
<p>Y añadamos los costes fijos que queramos, así como sus cantidades:</p>
<img alt="_images/invoice_add3.png" class="align-center" src="_images/invoice_add3.png" />
<p>En este punto, podemos generar la factura pulsando:</p>
<img alt="_images/invoice_add4.png" class="align-center" src="_images/invoice_add4.png" />
<p>Pulsando el siguiente botón podemos ver las llamadas que han sido incluidas en
la factura:</p>
<img alt="_images/invoice_add5.png" class="align-center" src="_images/invoice_add5.png" />
<p>Y pulsando este botón podemos descargar la factura en formato PDF:</p>
<img alt="_images/invoice_add6.png" class="align-center" src="_images/invoice_add6.png" />
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">La fecha fin tiene que ser una fecha ya pasada. Es decir, no se
puede sacar facturas de tramos futuros o del día actual.</p>
</div>
<div class="admonition error">
<p class="first admonition-title">Error</p>
<p class="last">Todas las llamadas del tramo escogido tienen que estar facturadas
para poder emitir la factura.</p>
</div>
</div>
</div>
</div>
</div>
<span id="document-provisioning/index"></span><div class="section" id="p-provision-de-terminales">
<span id="provisioning"></span><h2>[P] Provisión de terminales<a class="headerlink" href="#p-provision-de-terminales" title="Permalink to this headline">¶</a></h2>
<div class="section" id="esquema-de-provision">
<h3>Esquema de provisión<a class="headerlink" href="#esquema-de-provision" title="Permalink to this headline">¶</a></h3>
</div>
<div class="section" id="terminales-soportados">
<h3>Terminales soportados<a class="headerlink" href="#terminales-soportados" title="Permalink to this headline">¶</a></h3>
</div>
<div class="section" id="sistema-de-plantillas">
<h3>Sistema de plantillas<a class="headerlink" href="#sistema-de-plantillas" title="Permalink to this headline">¶</a></h3>
</div>
</div>
<span id="document-faxing/index"></span><div class="section" id="faxing-virtual">
<span id="faxing-system"></span><h2>Faxing Virtual<a class="headerlink" href="#faxing-virtual" title="Permalink to this headline">¶</a></h2>
<p>La solución de <em>faxing</em> virtual incluida en IvozProvider es muy simple, pero
permite:</p>
<ul class="simple">
<li>Enviar faxes partiendo de un PDF.</li>
<li>Recibir faxes vía correo electrónico y visualización web.</li>
</ul>
<div class="admonition error">
<p class="first admonition-title">Error</p>
<p class="last">IvozProvider utiliza <a class="reference external" href="http://www.voip-info.org/wiki/view/T.38">T.38</a> para la emisión y recepción de faxes. Es responsabilidad de el administrador de marca disponer de Contratos de Peering con operadores que soporten dicho protocolo, así como configurar las rutas de salida para utilizar dicho operador.</p>
</div>
<div class="section" id="creacion-de-un-fax-virtual">
<h3>Creación de un fax virtual<a class="headerlink" href="#creacion-de-un-fax-virtual" title="Permalink to this headline">¶</a></h3>
<p>Esta es la interfaz que nos encontramos al crear un nuevo fax en la sección
<strong>Configuración de empresa</strong> &gt; <strong>Faxes Virtuales</strong>:</p>
<img alt="_images/fax_add.png" class="align-center" src="_images/fax_add.png" />
<p>Los campos son prácticamente auto-explicativos:</p>
<dl class="glossary docutils">
<dt id="term-nombre">Nombre</dt>
<dd>Nombre por el que se referenciará el fax en otras secciones</dd>
<dt id="term-email">Email</dt>
<dd>Email donde se recibirán los mails (en caso de marcar &#8216;Enviar por
email&#8217; a &#8216;Sí&#8217;)</dd>
<dt id="term-ddi-de-salida">DDI de salida</dt>
<dd>Número que se utilizará como origen en los faxes salientes</dd>
</dl>
<p>Para recibir faxes en dicha numeración, será necesario apuntarla a nuestro
nuevo fax, editando el DDI en la sección <strong>DDIs</strong>:</p>
<img alt="_images/fax_ddi.png" class="align-center" src="_images/fax_ddi.png" />
<p>Para enviar faxes por una ruta concreta (que tenemos probada y sabemos que es
óptima para la emisión de faxes), se puede definir una ruta exclusiva para
faxes:</p>
<img alt="_images/fax_routes.png" class="align-center" src="_images/fax_routes.png" />
<p>Todos los faxes que envíe esa empresa (para todos los faxes que vaya creando),
se enviará por esta ruta.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Si se definieran más rutas de faxing, se utilizarían todas siguiendo
las lógicas de <em>load-balancing</em> y <em>failover</em> descritas en <a class="reference internal" href="index.html#routes-metrics"><span class="std std-ref">secciones
anteriores</span></a>.</p>
</div>
<div class="admonition important">
<p class="first admonition-title">Important</p>
<p class="last">Si una empresa no dispone de rutas de faxing, saldrá siguiendo
las lógicas de rutado de las llamadas.</p>
</div>
</div>
<div class="section" id="emitir-un-fax">
<h3>Emitir un fax<a class="headerlink" href="#emitir-un-fax" title="Permalink to this headline">¶</a></h3>
<img alt="_images/fax_send2.png" class="align-center" src="_images/fax_send2.png" />
<img alt="_images/fax_send.png" class="align-center" src="_images/fax_send.png" />
</div>
<div class="section" id="visualizacion-de-faxes-entrantes">
<h3>Visualización de faxes entrantes<a class="headerlink" href="#visualizacion-de-faxes-entrantes" title="Permalink to this headline">¶</a></h3>
<p>Los faxes entrantes se pueden recibir vía correo electrónico, pero también
pueden ser visualizados y descargados desde el panel web pulsando:</p>
<img alt="_images/fax_list.png" src="_images/fax_list.png" />
</div>
</div>
<span id="document-userportal/index"></span><div class="section" id="p-portal-de-usuario">
<span id="userportal"></span><h2>[P] Portal de Usuario<a class="headerlink" href="#p-portal-de-usuario" title="Permalink to this headline">¶</a></h2>
<div class="section" id="credenciales-de-acceso">
<h3>Credenciales de acceso<a class="headerlink" href="#credenciales-de-acceso" title="Permalink to this headline">¶</a></h3>
</div>
<div class="section" id="urls-de-acceso">
<h3>URLs de acceso<a class="headerlink" href="#urls-de-acceso" title="Permalink to this headline">¶</a></h3>
</div>
<div class="section" id="funcionalidades">
<h3>Funcionalidades<a class="headerlink" href="#funcionalidades" title="Permalink to this headline">¶</a></h3>
<div class="section" id="estado-del-registro-sip">
<h4>Estado del registro SIP<a class="headerlink" href="#estado-del-registro-sip" title="Permalink to this headline">¶</a></h4>
</div>
<div class="section" id="configuracion-basica-a-nivel-de-usuario">
<h4>Configuración básica a nivel de usuario<a class="headerlink" href="#configuracion-basica-a-nivel-de-usuario" title="Permalink to this headline">¶</a></h4>
</div>
</div>
</div>
</div>
<div class="toctree-wrapper compound" id="security">
<span id="document-security/index"></span><div class="section" id="s-elementos-de-seguridad">
<h2>[S] Elementos de seguridad<a class="headerlink" href="#s-elementos-de-seguridad" title="Permalink to this headline">¶</a></h2>
<div class="section" id="firewall-con-geoip">
<h3>Firewall con geoIP<a class="headerlink" href="#firewall-con-geoip" title="Permalink to this headline">¶</a></h3>
</div>
<div class="section" id="rangos-de-ip-autorizados-por-empresa">
<h3>Rangos de IP autorizados por empresa<a class="headerlink" href="#rangos-de-ip-autorizados-por-empresa" title="Permalink to this headline">¶</a></h3>
<p>En el proceso de creación de empresas nos saltamos deliberademente un mecanismo
de seguridad que <strong>limita las direcciones IP o rangos de red que pueden
utilizar las credenciales de los terminales de una empresa concreta</strong>.</p>
<p>Se puede activar en la sección <strong>Configuración de Marca</strong> &gt; <strong>Empresas</strong>:</p>
<img alt="_images/authorized_ips2.png" class="align-center" src="_images/authorized_ips2.png" />
<p>Todo usuario que quiera conectarse desde una red no incluida no podrá, a pesar
de disponer de unas credenciales válidas.</p>
<div class="admonition error">
<p class="first admonition-title">Error</p>
<p class="last">Una vez activado el filtrado, <strong>es obligatorio</strong> añadir redes o
direcciones válidas o, por el contrario, todas las llamadas se rechazarán:</p>
</div>
<img alt="_images/authorized_ips.png" src="_images/authorized_ips.png" />
<p>Se pueden añadir direcciones IP y rangos de direcciones, en formato CIDR
(IP/mask):</p>
<img alt="_images/authorized_ips3.png" src="_images/authorized_ips3.png" />
<div class="admonition important">
<p class="first admonition-title">Important</p>
<p class="last">Este mecanismo limita los orígenes de los usuarios de una
empresa, no filtra en absoluto los orígenes de los <strong>Contratos de Peering</strong>.</p>
</div>
</div>
<div class="section" id="anti-flooding">
<h3>Anti-flooding<a class="headerlink" href="#anti-flooding" title="Permalink to this headline">¶</a></h3>
<p>IvozProvider incorpora un mecanismo de <em>anti-flooding</em> que evita que un emisor
sature nuestra plataforma enviando peticiones. Ambos <em>proxies</em> (usuarios y
salida) incorporan este mecanismo, que <strong>limita el número de peticiones desde
un dirección origen en un tramo concreto de tiempo</strong>.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Cuando un origen llega al límite, el proxy dejará de contestarle
durante un tiempo dado. Pasado ese tiempo, volverá a contestarle con
normalidad.</p>
</div>
<p>Ciertos orígenes que están automáticamente excluidos de este mecanismo de
<em>anti-flooding</em>:</p>
<ul class="simple">
<li>Servidores de aplicación de la plataforma.</li>
<li>IPs o rangos autorizados de empresas (ver sección anterior).</li>
</ul>
<p>El operador global puede añadir otras direcciones que queden excluidas de este
mecanismo por medio del apartado <strong>Configuración global</strong> &gt; <strong>IPs de
confianza</strong>:</p>
<img alt="_images/trusted_ips.png" src="_images/trusted_ips.png" />
</div>
<div class="section" id="limite-de-llamadas-concurrentes">
<h3>Límite de llamadas concurrentes<a class="headerlink" href="#limite-de-llamadas-concurrentes" title="Permalink to this headline">¶</a></h3>
<p>Otro mecanismo de seguridad que puede evitar que unas credenciales
comprometidas sean utilizadas para establecer cientos de llamadas en poco
tiempo, es el mecanismo que <strong>limita el número de llamadas externas</strong> de
cada empresa.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Este mecanismo tiene en cuenta los canales externos concurrentes, es
decir, cuenta llamadas externas entrantes y llamadas externas salientes.</p>
</div>
<p>Se puede configurar editando una empresa y fijando el valor del siguiente campo:</p>
<img alt="_images/call_limit.png" class="align-center" src="_images/call_limit.png" />
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p class="last">Para desactivar este mecanismo, basta con fijar el valor a 0.</p>
</div>
</div>
</div>
<span id="document-maintenance/index"></span><div class="section" id="p-mantenimiento-de-la-solucion">
<h2>[P] Mantenimiento de la solución<a class="headerlink" href="#p-mantenimiento-de-la-solucion" title="Permalink to this headline">¶</a></h2>
<p>A continuación se describen las herramientas que incorpora IvozProvider para
facilitar el mantenimiento de la solución:</p>
<div class="toctree-wrapper compound">
<span id="document-maintenance/sip_captures"></span><div class="section" id="capturador-de-trafico-sip-homer">
<h3>Capturador de tráfico SIP: Homer<a class="headerlink" href="#capturador-de-trafico-sip-homer" title="Permalink to this headline">¶</a></h3>
</div>
<span id="document-maintenance/log_viewer"></span><div class="section" id="visor-de-logs-graylog">
<h3>Visor de logs: Graylog<a class="headerlink" href="#visor-de-logs-graylog" title="Permalink to this headline">¶</a></h3>
</div>
<span id="document-maintenance/platform_graphs"></span><div class="section" id="graficas-de-la-plataforma-grafana">
<h3>Gráficas de la plataforma: Grafana<a class="headerlink" href="#graficas-de-la-plataforma-grafana" title="Permalink to this headline">¶</a></h3>
</div>
</div>
</div>
</div>
</div>


           </div>
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016, Irontec.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  
<div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
        <span class="fa fa-book"> Other Versions</span>
        v: v1.1.0
        <span class="fa fa-caret-down"></span>
    </span>
    <div class="rst-other-versions">
        <dl>
            <dt>Tags</dt>
            <dd><a href="../v1.0.0/index.html">v1.0.0</a></dd>
            <dd><a href="index.html">v1.1.0</a></dd>
            <dd><a href="../v1.2.0/index.html">v1.2.0</a></dd>
            <dd><a href="../v1.3.0/index.html">v1.3.0</a></dd>
            <dd><a href="../v1.4.0/index.html">v1.4.0</a></dd>
            <dd><a href="../v1.5.0/index.html">v1.5.0</a></dd>
            <dd><a href="../v1.6.0/index.html">v1.6.0</a></dd>
            <dd><a href="../v1.6.1/index.html">v1.6.1</a></dd>
            <dd><a href="../v1.6.2/index.html">v1.6.2</a></dd>
            <dd><a href="../v1.6.3/index.html">v1.6.3</a></dd>
            <dd><a href="../v1.7.0/index.html">v1.7.0</a></dd>
            <dd><a href="../v1.7.1/index.html">v1.7.1</a></dd>
            <dd><a href="../v2.0.0/index.html">v2.0.0</a></dd>
            <dd><a href="../v2.1.0/index.html">v2.1.0</a></dd>
            <dd><a href="../v2.10.0/index.html">v2.10.0</a></dd>
            <dd><a href="../v2.11.0/index.html">v2.11.0</a></dd>
            <dd><a href="../v2.11.1/index.html">v2.11.1</a></dd>
            <dd><a href="../v2.11.2/index.html">v2.11.2</a></dd>
            <dd><a href="../v2.12.0/index.html">v2.12.0</a></dd>
            <dd><a href="../v2.2.0/index.html">v2.2.0</a></dd>
            <dd><a href="../v2.3.0/index.html">v2.3.0</a></dd>
            <dd><a href="../v2.4.0/index.html">v2.4.0</a></dd>
            <dd><a href="../v2.5.0/index.html">v2.5.0</a></dd>
            <dd><a href="../v2.6.0/index.html">v2.6.0</a></dd>
            <dd><a href="../v2.7.0/index.html">v2.7.0</a></dd>
            <dd><a href="../v2.7.1/index.html">v2.7.1</a></dd>
            <dd><a href="../v2.8.0/index.html">v2.8.0</a></dd>
            <dd><a href="../v2.8.1/index.html">v2.8.1</a></dd>
            <dd><a href="../v2.9.0/index.html">v2.9.0</a></dd>
            <dd><a href="../v2.9.1/index.html">v2.9.1</a></dd>
            <dd><a href="../v2.9.2/index.html">v2.9.2</a></dd>
            <dd><a href="../v2.9.3/index.html">v2.9.3</a></dd>
        </dl>
        <dl>
            <dt>Branches</dt>
            <dd><a href="../artemis/index.html">artemis</a></dd>
            <dd><a href="../bleeding/index.html">bleeding</a></dd>
            <dd><a href="../oasis/index.html">oasis</a></dd>
        </dl>
    </div>
</div>


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'Oasis',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>